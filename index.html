<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#0c4ea2">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <link rel="apple-touch-icon" href="images/icon-192x192.png">

  <title>Freediving Scheduler</title>
  <style>
    /* --- CSS (ì´ì „ê³¼ ë™ì¼) --- */
    body { background: linear-gradient(to bottom, #c3e0f7, #2d8cd5, #0c4ea2); min-height: 100vh; font-family: Arial, sans-serif; margin: 0; padding: 0; line-height: 1.6; }
    .container { max-width: 1200px; margin: 0 auto; padding: 2rem 1rem; }
    .text-center { text-align: center; }
    .text-white { color: white; }
    .mb-4 { margin-bottom: 1rem; }
    .mb-6 { margin-bottom: 1.5rem; }
    .mb-8 { margin-bottom: 2rem; }
    .text-4xl { font-size: 2.25rem; }
    .text-2xl { font-size: 1.5rem; }
    .text-xl { font-size: 1.25rem; }
    .font-bold { font-weight: bold; }
    .bg-white { background-color: white; }
    .bg-opacity-90 { background-color: rgba(255, 255, 255, 0.9); }
    .rounded-lg { border-radius: 0.5rem; }
    .p-6 { padding: 1.5rem; }
    .grid { display: grid; grid-template-columns: repeat(1, 1fr); gap: 1.5rem; }
    @media (min-width: 768px) { #inputSection .grid { grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); } }
    @media (min-width: 1024px) { #inputSection .grid { grid-template-columns: repeat(3, 1fr); } }
    @media (min-width: 768px) { #scheduleContainer.grid { grid-template-columns: repeat(2, 1fr); } }
    @media (min-width: 1200px) { #scheduleContainer.grid { grid-template-columns: repeat(3, 1fr); } }
    .text-blue-800 { color: #2c5282; }
    .mb-2 { margin-bottom: 0.5rem; }
    .w-full { width: 100%; }
    .p-2 { padding: 0.5rem; }
    .border { border: 1px solid; }
    .border-gray-300 { border-color: #e2e8f0; }
    .rounded { border-radius: 0.25rem; }
    .mt-6 { margin-top: 1.5rem; }
    .bg-blue-600 { background-color: #3182ce; }
    .bg-blue-600:hover { background-color: #2c5282; }
    .bg-print-600 { background-color: #38a169; }
    .bg-print-600:hover { background-color: #276749; }
    .bg-purple-600 { background-color: #805ad5; }
    .bg-purple-600:hover { background-color: #6b46c1; }
    .py-3 { padding-top: 0.75rem; padding-bottom: 0.75rem; }
    .px-6 { padding-left: 1.5rem; padding-right: 1.5rem; }
    .text-gray-700 { color: #4a5568; }
    .cursor-pointer { cursor: pointer; }
    #trainingPrecautionsContainer,
    #generalNutritionTipsContainer { background-color: rgba(255, 255, 255, 0.88); border-radius: 8px; padding: 1rem 1.5rem; margin-bottom: 1.5rem; display: none; border: 1px solid #ddd; box-shadow: 0 2px 4px rgba(0,0,0,0.05); }
    #trainingPrecautionsContainer h4,
    #generalNutritionTipsContainer h4 { font-size: 1.15rem; margin-top: 0; margin-bottom: 0.85rem; border-bottom: 1px solid #eee; padding-bottom: 0.6rem; }
    #trainingPrecautionsContainer ul,
    #generalNutritionTipsContainer ul { padding-left: 1.2rem; margin: 0; font-size: 0.9rem; color: #4a5568; }
    #trainingPrecautionsContainer li,
    #generalNutritionTipsContainer li { margin-bottom: 0.4rem; line-height: 1.5; }
    #trainingPrecautionsContainer h4 { color: #c53030; }
    #trainingPrecautionsContainer ul { list-style-type: 'âš ï¸ '; color: #525252; }
    #generalNutritionTipsContainer ul { list-style-type: 'ğŸ’¡ '; }
    .schedule-card { background-color: rgba(255, 255, 255, 0.9); border-radius: 10px; box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1); margin-bottom: 1.5rem; display: flex; flex-direction: column;}
    .day-title { background-color: #0c4ea2; color: white; border-radius: 10px 10px 0 0; padding: 8px 15px; font-weight: bold; flex-shrink: 0; }
    .dry-day { background-color: #A0AEC0; }
    .openwater-day-title { background-color: #1e6091; }
    .restricted-day-title { background-color: #3182ce; }
    .card-content { padding: 15px; flex-grow: 1; }
    .list-disc { list-style-type: none; padding-left: 0; margin-top: 0.5rem; margin-bottom: 0.5rem;}
    .list-disc li { margin-bottom: 0.75rem; }
    .list-disc label { display: flex; align-items: flex-start; cursor: pointer; }
    .exercise-checkbox { margin-right: 0.6rem; margin-top: 0.2rem; flex-shrink: 0; }
    .exercise-text { flex-grow: 1; transition: color 0.2s, text-decoration 0.2s; }
    .exercise-details { margin-left: 1.8rem; }
    .exercise-info, .nutrition-info { font-size: 0.85rem; color: #5a67d8; margin-top: 4px; font-style: italic; }
    .exercise-category, .nutrition-category { background-color: #e6f0ff; padding: 6px 12px; border-radius: 5px; margin-top: 12px; margin-bottom: 8px; font-weight: bold; color: #2b4f76; }
    .difficulty-info { color: #e03c31; font-style: italic; font-size: 0.85rem; margin-top: 4px; }
    .difficulty-info strong { color: #c53030; margin-right: 4px; font-style: normal; }
    .caution { color: #b91c1c; font-style: italic; font-size: 0.85rem; margin-top: 4px; }
    .sets { font-size: 0.85rem; color: #2b6cb0; font-weight: bold; margin-left: 0.3rem;}
    .duration { font-size: 0.85rem; color: #2b6cb0; font-style: italic; margin-left: 0.3rem;}
    .rest-info { font-style: italic; color: #4a5568; margin-bottom: 10px; }
    .exercise-checkbox:checked + .exercise-text { text-decoration: line-through; color: #777; }
    .button-row { display: flex; flex-wrap: wrap; gap: 1rem; margin-top: 1.5rem; }
    .button-row button { flex: 1; min-width: 200px; }
    .modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0, 0, 0, 0.5); z-index: 1000; justify-content: center; align-items: center; }
    .modal-content { background-color: white; padding: 2rem; border-radius: 0.5rem; max-width: 500px; width: 90%; }
    .close { color: #aaa; float: right; font-size: 28px; font-weight: bold; cursor: pointer; }
    .share-option { display: block; margin: 1rem 0; padding: 1rem; border: 1px solid #ddd; border-radius: 0.5rem; cursor: pointer; transition: background-color 0.3s; }
    .share-option:hover { background-color: #f5f5f5; }
    .loader { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0, 0, 0, 0.5); z-index: 2000; justify-content: center; align-items: center; }
    .loader-content { background-color: white; padding: 2rem; border-radius: 0.5rem; text-align: center; }
    .spinner { border: 4px solid #f3f3f3; border-top: 4px solid #3498db; border-radius: 50%; width: 40px; height: 40px; animation: spin 2s linear infinite; margin: 1rem auto; }
    @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
    .training-selection { margin-top: 1rem; margin-bottom: 1rem; padding: 1rem; background-color: #f8fafd; border-radius: 0.5rem; }
    .training-selection h3 { margin-top: 0; margin-bottom: 0.75rem; color: #2c5282; font-size: 1.1rem; }
    .training-selection label { display: inline-block; margin-right: 1rem; margin-bottom: 0.5rem; cursor: pointer; }
    .training-selection input[type="checkbox"] { margin-right: 0.3rem; }
    .nutrition-item { margin-bottom: 0.75rem; }
    .nutrition-item strong { color: #1a365d; }

    /* --- Print Styles --- */
    @media print { /* ... (ì´ì „ê³¼ ë™ì¼) ... */ }
  </style>
</head>
<body>
  <div class="container"> <div class="text-center mb-8"> <h1 class="text-4xl font-bold text-white mb-4">Freediving Scheduler</h1> <p class="text-xl text-white mb-6" id="subTitle">ê°œì¸ ëª©í‘œì— ë§ì¶˜ í›ˆë ¨ ë° ì˜ì–‘ ê³„íš</p> </div> <div id="inputSection" class="bg-white bg-opacity-90 rounded-lg p-6 mb-8"> <h2 class="text-2xl font-bold mb-4 text-blue-800">íŠ¸ë ˆì´ë‹ ê³„íš ìƒì„±</h2> <div class="grid"> <div> <label class="block text-gray-700 mb-2" for="userName">ì´ë¦„</label> <input type="text" id="userName" placeholder="ì´ë¦„ ì…ë ¥" class="w-full p-2 border border-gray-300 rounded"> </div> <div> <label class="block text-gray-700 mb-2" for="targetDiscipline">ì£¼ ì¢…ëª©</label> <select id="targetDiscipline" class="w-full p-2 border border-gray-300 rounded"> <option value="CWT">CWT (Constant Weight)</option> <option value="CWTB">CWTB (Constant Weight Bi-Fins)</option> <option value="FIM">FIM (Free Immersion)</option> <option value="CNF">CNF (Constant Weight No Fins)</option> </select> </div> <div> <label class="block text-gray-700 mb-2" for="currentPb">í˜„ì¬ PB (m)</label> <input type="number" id="currentPb" placeholder="ì˜ˆ: 40" class="w-full p-2 border border-gray-300 rounded" min="5"> </div> <div> <label class="block text-gray-700 mb-2" for="targetRecord">ëª©í‘œ ìˆ˜ì‹¬ (m)</label> <input type="number" id="targetRecord" placeholder="ì˜ˆ: 50" class="w-full p-2 border border-gray-300 rounded" min="10"> </div> <div> <label class="block text-gray-700 mb-2" for="trainingDays">íŠ¸ë ˆì´ë‹ ê¸°ê°„</label> <select id="trainingDays" class="w-full p-2 border border-gray-300 rounded"> <option value="7">7ì¼</option> <option value="10">10ì¼</option> <option value="14" selected>14ì¼</option> <option value="21">21ì¼</option> <option value="30">30ì¼</option> </select> </div> <div> <label class="block text-gray-700 mb-2" for="experienceLevel">ê²½í—˜ ìˆ˜ì¤€ (ìë™ ì œì•ˆ)</label> <select id="experienceLevel" class="w-full p-2 border border-gray-300 rounded" disabled> <option value="beginner">ì´ˆê¸‰ ( ~25m)</option> <option value="intermediate">ì¤‘ê¸‰ (26m ~ 45m)</option> <option value="advanced">ê³ ê¸‰ (46m+)</option> </select> </div> <div> <label class="block text-gray-700 mb-2" for="includeNutrition">ì˜ì–‘ ê´€ë¦¬</label> <select id="includeNutrition" class="w-full p-2 border border-gray-300 rounded"> <option value="yes" selected>ì‹ë‹¨&ì˜ì–‘ì œ í¬í•¨</option> <option value="no">í›ˆë ¨ ì¼ì •ë§Œ</option> </select> </div> <div style="grid-column: span 1 / span 1;"> <label class="block text-gray-700 mb-2" for="includeExplanations">íŠ¸ë ˆì´ë‹ ì„¤ëª…</label> <select id="includeExplanations" class="w-full p-2 border border-gray-300 rounded"> <option value="yes" selected>í›ˆë ¨ ë°©ë²•&íš¨ê³¼ í¬í•¨</option> <option value="no">í›ˆë ¨ ì¼ì •ë§Œ</option> </select> </div> </div> <div class="training-selection"> <h3>í¬í•¨í•  í›ˆë ¨ ì¢…ë¥˜ ì„ íƒ</h3> <label><input type="checkbox" name="trainingType" value="breath" checked> í˜¸í¡</label> <label><input type="checkbox" name="trainingType" value="pressure" checked> ì••ë ¥í‰í˜•</label> <label><input type="checkbox" name="trainingType" value="openWater" checked> ê°œë°©ìˆ˜ì—­</label> <label><input type="checkbox" name="trainingType" value="restricted" checked> ì œí•œìˆ˜ì—­(ìˆ˜ì˜ì¥)</label> <label><input type="checkbox" name="trainingType" value="strength" checked> ì²´ë ¥</label> </div> <div class="button-row"> <button onclick="generateScheduleWrapper()" class="bg-blue-600 text-white font-bold py-3 px-6 rounded-lg cursor-pointer">ìŠ¤ì¼€ì¤„ ìƒì„±í•˜ê¸°</button> <button onclick="printSchedule()" class="bg-print-600 text-white font-bold py-3 px-6 rounded-lg cursor-pointer">ì¶œë ¥í•˜ê¸°</button> <button onclick="openShareModal()" class="bg-purple-600 text-white font-bold py-3 px-6 rounded-lg cursor-pointer">ê³µìœ í•˜ê¸°</button> </div> </div>
     <div id="printHeaderInfo" style="display: none;"> <h1 id="printUserNameTitle">ë‹˜ì˜ ë”¥ í”„ë¦¬ë‹¤ì´ë¹™ íŠ¸ë ˆì´ë‹ ê³„íš</h1> <p id="printParams"></p> </div>
     <div id="trainingPrecautionsContainer"></div>
     <div id="generalNutritionTipsContainer"></div>
     <div id="scheduleContainer"></div>
   </div>
   <div id="shareModal" class="modal"> <div class="modal-content"> <span class="close" onclick="closeShareModal()">&times;</span> <h2 class="text-2xl font-bold mb-4">ê³µìœ í•˜ê¸°</h2> <div class="share-option" onclick="shareViaLink()"> <h3 class="font-bold">ë§í¬ ê³µìœ </h3> <p>í˜„ì¬ ì„¤ì • ë§í¬ ë³µì‚¬</p> </div> <div class="share-option" onclick="shareViaEmail()"> <h3 class="font-bold">ì´ë©”ì¼ ê³µìœ </h3> <p>ìŠ¤ì¼€ì¤„ ë§í¬ ì´ë©”ì¼ ì „ì†¡</p> </div> <div class="share-option" onclick="shareViaSocialMedia()"> <h3 class="font-bold">SNS ê³µìœ </h3> <p>ìŠ¤ì¼€ì¤„ ë§í¬ SNS ê³µìœ </p> </div> </div> </div>
   <div id="loader" class="loader"> <div class="loader-content"> <div class="spinner"></div> <p id="loaderText">ì²˜ë¦¬ ì¤‘...</p> </div> </div>

  <script>
    // --- Data Definition ---
    const data = {
        breath: [ { name: "íŒ¨í‚¹ ê¸°ë²• í›ˆë ¨", method: "ìµœì¢…í˜¸í¡ í›„ ë¹ ë¥´ê²Œ ì…ì•ˆ ê³µê¸°ê³µê°„ì„ ë§Œë“¤ì–´ ê³µê¸° ì‚¼í‚¤ëŠ” ê²ƒì„ ë°˜ë³µ. ì ì§„ì ìœ¼ë¡œ íŒ¨í‚¹ íšŸìˆ˜ ëŠ˜ë¦¬ê¸°.", effect: "ì´ íìš©ì  ì¦ê°€, ê³µê¸° ì €ì¥ëŸ‰ ì¦ëŒ€, í‰ê³½ ìœ ì—°ì„± í–¥ìƒ", sets: 3, difficultyAdjustments: { beginner: "ê°€ë³ê²Œ 5-10íšŒ ì‹œë„, ë¬´ë¦¬í•˜ì§€ ì•Šê¸°", intermediate: "10-15íšŒ ëª©í‘œ, í ì••ë°•ê° ëŠë¼ë©° ì¡°ì ˆ", advanced: "15íšŒ ì´ìƒ, ìµœëŒ€ íŒ¨í‚¹ í›„ ì••ë ¥ ìœ ì§€ ì—°ìŠµ" }}, { name: "ë¦¬ë²„ìŠ¤ íŒ¨í‚¹ í›ˆë ¨", method: "ë‚ ìˆ¨ ì´í›„ ì…ì•ˆ ê³µê¸°ê³µê°„ ë§Œë“  í›„ ì²´ì™¸ë¡œ ë°°ì¶œ ë°˜ë³µ. ì ì§„ì ìœ¼ë¡œ ë¦¬ë²„ìŠ¤ íŒ¨í‚¹ íšŸìˆ˜ ëŠ˜ë¦¬ê¸°.", effect: "í ì”ê¸°ëŸ‰ ê°ì†Œ, í íƒ„ì„± í–¥ìƒ, ì••ë ¥ ë³€í™” ì ì‘ë ¥ í–¥ìƒ", sets: 3, difficultyAdjustments: { beginner: "ê°€ë³ê²Œ 5-10íšŒ ì‹œë„, í‰ê³½ ìˆ˜ì¶• ëŠë¼ê¸°", intermediate: "10-15íšŒ ëª©í‘œ, ê¹Šì€ ë‚ ìˆ¨ í›„ ìˆ˜í–‰", advanced: "15íšŒ ì´ìƒ, ìµœëŒ€ ë¦¬ë²„ìŠ¤ íŒ¨í‚¹ í›„ ì €ì‚°ì†Œ ìƒíƒœ ì ì‘ ì—°ìŠµ" }}, { name: "ì¹´íŒ”ë¼ë°”í‹° í˜¸í¡ë²•", method: "ë¹ ë¥´ê³  ê°•í•œ ë³µë¶€ ìˆ˜ì¶•ìœ¼ë¡œ ì½”ë¥¼ í†µí•´ ì§§ê²Œ ê³µê¸° 30íšŒ ì—°ì† ë°°ì¶œ í›„ ìˆ¨ì°¸ê¸°.", effect: "í˜¸í¡ê·¼ ê°•í™”, COâ‚‚ ë‚´ì„± ì¦ê°€, íš¡ê²©ë§‰ ì»¨íŠ¸ë¡¤ í–¥ìƒ", sets: 3, duration: "30íšŒ/ì„¸íŠ¸" }, { name: "STA (ì •ì  ë¬´í˜¸í¡)", method: "ìµœì¢…í˜¸í¡ ì´í›„ í¸ì•ˆí•œ ìì„¸ë¡œ ìˆ¨ì°¸ê¸° ì‹¤ì‹œ. ì»¨íŠ¸ë ‰ì…˜ ì‹œì‘ ì‹œê°„ ë° ìµœëŒ€ ê¸°ë¡ ì¸¡ì •.", effect: "ë¬´í˜¸í¡ ì‹œê°„ ì—°ì¥, ì €ì‚°ì†Œ/ê³ ì´ì‚°í™”íƒ„ì†Œ ë‚´ì„± ê°•í™”, ì‹¬ë¦¬ì  ì•ˆì •ê° ì¦ëŒ€", sets: 3, difficultyAdjustments: { beginner: "ëª©í‘œ: 1ë¶„ 30ì´ˆ ì´ìƒ / ì»¨íŠ¸ë ‰ì…˜ 1íšŒ ëŠë¼ê¸°", intermediate: "ëª©í‘œ: 2ë¶„ 30ì´ˆ ì´ìƒ / ì»¨íŠ¸ë ‰ì…˜ 3-5íšŒ ì°¸ê¸°", advanced: "ëª©í‘œ: 3ë¶„ 30ì´ˆ ì´ìƒ / ê°•í•œ ì»¨íŠ¸ë ‰ì…˜ì—ë„ ì´ì™„ ìœ ì§€" }} ],
        // ******** UPDATED pressure data ********
        pressure: [ { name: "ë¦¬ë²„ìŠ¤ íŒ¨í‚¹ & ë§ˆìš°ìŠ¤í•„ ìƒì„±/ìœ ì§€", method: "ê³µê¸° ë‚´ì‰° í›„ ë¦¬ë²„ìŠ¤ íŒ¨í‚¹ ì‹¤ì‹œ í›„ ì°¸ê³ , ì…ì•ˆ ì••ë ¥ìœ¼ë¡œ ë§ˆìš°ìŠ¤í•„ ìƒì„±í•˜ì—¬ ì••ë ¥ ìœ ì§€ ì—°ìŠµ.", effect: "ë§ˆìš°ìŠ¤í•„ ìƒì„±/ìœ ì§€ ëŠ¥ë ¥ í–¥ìƒ, ê¹Šì€ ìˆ˜ì‹¬ì—ì„œì˜ EQ ì•ˆì •ì„± í–¥ìƒ.", sets: 3, difficultyAdjustments: { beginner: "ë§ˆìš°ìŠ¤í•„ ì••ë ¥ ìƒì„± ë° 3ì´ˆ ìœ ì§€", intermediate: "ì••ë ¥ ìœ ì§€ ì‹œê°„ ëŠ˜ë¦¬ê¸° (5ì´ˆ ì´ìƒ)", advanced: "ê°•í•œ ì••ë ¥ìœ¼ë¡œ ë§ˆìš°ìŠ¤í•„ ìœ ì§€ ì‹œê°„ 10ì´ˆ ì´ìƒ í™•ë³´" }, tags: ['mouthfill'] }, { name: "ë³¼ ë¶€í’€ë¦¬ê¸° & ê³µê¸° ìœ ì§€ (ë§ˆìš°ìŠ¤í•„)", method: "ìµœì¢…í˜¸í¡ í›„ ì…ì•ˆì— ê³µê¸° ê°€ë“ ì±„ìš°ê³ (ë§ˆìš°ìŠ¤í•„) ì••ë ¥ ìœ ì§€.", effect: "ë§ˆìš°ìŠ¤í•„ ì••ë ¥í‰í˜• ê¸°ìˆ  ë° ì§€êµ¬ë ¥ í–¥ìƒ, ë³¼ê·¼ìœ¡ ê°•í™”", sets: 3, difficultyAdjustments: { beginner: "ì•½í•œ ì••ë ¥ìœ¼ë¡œ 3-5ì´ˆ ìœ ì§€", intermediate: "ì¤‘ê°„ ì••ë ¥ìœ¼ë¡œ 5-10ì´ˆ ìœ ì§€", advanced: "ìµœëŒ€ ì••ë ¥ ìœ ì§€ ì‹œê°„ 10ì´ˆ ì´ìƒ ëŠ˜ë¦¬ê¸° (ëª© ì›€ì§ì´ë©°)" }, tags: ['mouthfill'] }, { name: "ì„±ë¬¸ ë¶€ë¶„ì—´ê¸° & ê³µê¸° ì¡°ì ˆ", method: "ë§ˆìš°ìŠ¤í•„ ìƒíƒœì—ì„œ ì„±ë¬¸ì„ ì•½ê°„ ì—´ì–´ ì—°êµ¬ê°œë¡œ ê³µê¸° ì²œì²œíˆ ìƒˆì–´ë‚˜ì˜¤ê²Œ ì¡°ì ˆ. íê°€ ëˆŒë¦¬ëŠ” ëŠë‚Œ(íë¼ì„) íšŒí”¼ ì—°ìŠµ.", effect: "ì„±ë¬¸/ì—°êµ¬ê°œ ì¡°ì ˆ ëŠ¥ë ¥ í–¥ìƒ, ë§ˆìš°ìŠ¤í•„ ì •ë°€ë„ ê°œì„ , í ìƒí•´ ë°©ì§€", sets: 2, difficultyAdjustments: { beginner: "í ì••ë°•ê° ì—†ì´ ë¶€ë“œëŸ½ê²Œ ì¡°ì ˆí•˜ë©° ê³µê¸° íë¦„ ëŠë¼ê¸°", intermediate: "ì¼ì •í•œ ì†ë„ë¡œ ê³µê¸° íë¦„ ìœ ì§€, ë¶€ë“œëŸ¬ìš´ ì¡°ì ˆ ì—°ìŠµ (ì¶”ê°€ ì••ë ¥ ì‹œë„)", advanced: "ë§¤ìš° ëŠë¦¬ê³  ì •ë°€í•˜ê²Œ ê³µê¸° íë¦„ ì¡°ì ˆ (ê°•í•œ ì••ë ¥ ì ìš©)" } }, { name: "ë¦¬ë²„ìŠ¤ íŒ¨í‚¹ í›„ ì„±ë¬¸ ê°œë°©/ì´ì™„", method: "ê³µê¸° ë‚´ì‰° í›„ ë¦¬ë²„ìŠ¤ íŒ¨í‚¹ ì‹¤ì‹œ, ì´í›„ ì„±ë¬¸ì„ ë¶€ë“œëŸ½ê²Œ ì—´ì–´ ê³µê¸°ê°€ ì•½ê°„ ìƒˆì–´ ë‚˜ì˜¤ë„ë¡ ì´ì™„.", effect: "ë¦¬ë²„ìŠ¤ íŒ¨í‚¹ í›„ ì••ë ¥ ì¡°ì ˆ ëŠ¥ë ¥ í–¥ìƒ, ì„±ë¬¸ ì»¨íŠ¸ë¡¤", sets: 3, difficultyAdjustments: { beginner: "ë¶€ë“œëŸ½ê²Œ ì„±ë¬¸ ì—¬ëŠ” ëŠë‚Œ ì§‘ì¤‘ (3ì´ˆ)", intermediate: "ê°œë°©/ì´ì™„ ì‹œê°„ ëŠ˜ë¦¬ê¸° (5ì´ˆ)", advanced: "ì™„ì „ ì´ì™„ ìƒíƒœì—ì„œ 10ì´ˆ ì´ìƒ ìœ ì§€" } }, { name: "ë§ˆìš°ìŠ¤í•„ ì••ë ¥ ì¡°ì ˆ/ê°•í™”", method: "ë§ˆìš°ìŠ¤í•„ ìƒíƒœì—ì„œ ì••ë ¥ì˜ ê°•ë„ë¥¼ ì˜ë„ì ìœ¼ë¡œ ì¡°ì ˆ(ê°•/ì¤‘/ì•½)í•˜ëŠ” ì—°ìŠµ ë˜ëŠ” ì¼ì •í•œ ì••ë ¥ì„ ìœ ì§€í•˜ë©° ë²„í‹°ëŠ” ì—°ìŠµ.", effect: "ë§ˆìš°ìŠ¤í•„ ì••ë ¥ ì œì–´ ëŠ¥ë ¥ í–¥ìƒ, EQ ì§€êµ¬ë ¥ ê°•í™”", sets: 3, difficultyAdjustments: { beginner: "ì•½í•œ ì••ë ¥ìœ¼ë¡œ ì§§ê²Œ ì¡°ì ˆ/ìœ ì§€ ì—°ìŠµ", intermediate: "ì¤‘ê°„ ê°•ë„ ì••ë ¥ìœ¼ë¡œ ì¡°ì ˆ ë¹ˆë„ ë†’ì´ê¸° ë˜ëŠ” ìœ ì§€ ì‹œê°„ ì¦ê°€", advanced: "ê°•í•œ ì••ë ¥ ìœ ì§€ ë° ë¯¸ì„¸ ì¡°ì ˆ ëŠ¥ë ¥ í–¥ìƒ" }, tags: ['mouthfill'] }, { name: "ë§ˆìš°ìŠ¤í•„ ì¶©ì „ ì—°ìŠµ (EQ Tool/Oto-vent)", method: "EQ Tool ë˜ëŠ” Oto-vent í’ì„  ë¶ˆê¸° í™œìš©. ì½” ë§‰ê³  ì…ì•ˆ ì••ë ¥ìœ¼ë¡œ í’ì„  ë¶€í’€ë¦¬ê¸°.", effect: "ë§ˆìš°ìŠ¤í•„ ì••ë ¥ ìƒì„± ë° ì´ê´€ ê°œë°© ëŠ¥ë ¥ í–¥ìƒ.", sets: 3, reps: "5-10íšŒ ë¶ˆê¸°", tags: ['mouthfill'], difficultyAdjustments: { intermediate: "ë¶€ë“œëŸ½ê²Œ ë¶ˆê¸° ì—°ìŠµ", advanced: "ê°•í•œ ì••ë ¥ìœ¼ë¡œ ë¹ ë¥´ê²Œ ë¶ˆê¸° ì—°ìŠµ"} } ],
        openWater: [ { name: "í”„ë¦¬ì´ë©€ì…˜ + ì¤‘ì„±ë¶€ë ¥ì²´í¬ + í–‰ì‰", _template: true, method: "ì¤‘ì„±ë¶€ë ¥ ìˆ˜ì‹¬ê¹Œì§€ ë¡œí”„ì¡ê³  í•˜ê°• í›„ ë¡œí”„ ë†“ê³  ì»¨íŠ¸ë ‰ì…˜ í™•ì¸. ë¡œí”„ì¡ê³  ìƒìŠ¹í•˜ëŠ” ì—°ìŠµ í¬í•¨.", effect: "FIMê¸°ìˆ í–¥ìƒ, ë¶€ë ¥ê°ê° í–¥ìƒ, ì»¨íŠ¸ë ‰ì…˜ ì ì‘", sets: 2, difficultyAdjustments: { beginner: "5-10m / ì»¨íŠ¸ë¡¤ëœ í•˜ê°•ê³¼ ë¶€ë“œëŸ¬ìš´ ìƒìŠ¹ ì§‘ì¤‘", intermediate: "10-15m / ì»¨íŠ¸ë ‰ì…˜ ë°œìƒ ì‹œ ì´ì™„ ìœ ì§€ ì—°ìŠµ", advanced: "15m ì´ìƒ / ì»¨íŠ¸ë ‰ì…˜ ì¤‘ ì´ì™„ ìœ ì§€ ë° ìƒìŠ¹ ì»¨íŠ¸ë¡¤" }}, { name: "ëª©í‘œ ì¢…ëª© PB ë‹¤ì´ë¹™", _template: true, method: "ì›Œë°ì—… í›„, ì„ íƒí•œ ì£¼ ì¢…ëª©(CWT/CWTB/FIM/CNF)ìœ¼ë¡œ ë‹¹ì¼ ê³„ì‚°ëœ ëª©í‘œ ìˆ˜ì‹¬ ë²”ìœ„ ë‚´ì—ì„œ 1íšŒ ë„ì „.", effect: "ì‹¬ë¦¬ì  í•œê³„ ê·¹ë³µ ë° ì ì§„ì  ê¸°ë¡ ê²½ì‹  ì‹œë„, ëª©í‘œ ìˆ˜ì‹¬ ì ì‘", caution: "ì»¨ë””ì…˜ ìµœìƒì¼ ë•Œë§Œ ì‹œë„. ë¶ˆì•ˆ, ì••ë ¥í‰í˜• ë¬¸ì œ, ì €ì²´ì˜¨ ë“± ë°œìƒ ì‹œ ì ˆëŒ€ ë¬´ë¦¬í•˜ì§€ ë§ê³  ì¦‰ì‹œ ì•ˆì „í•˜ê²Œ ìƒìŠ¹." }, { name: "CO2 FIM", _template: true, method: "ìˆ˜ë©´ì—ì„œ ë²„í‹°ì»¬ í”¼ë‹(ë‹¤ë¦¬ë§Œ) 30ì´ˆ í›„ ìµœì¢…í˜¸í¡, ëª©í‘œ ìˆ˜ì‹¬ê¹Œì§€ FIM ìˆ˜í–‰.", effect: "FIM ê¸°ìˆ  í–¥ìƒ, CO2 ë‚´ì„± ì¦ê°€, ê¸´ì¥ ì™„í™” ê¸°ìˆ  í–¥ìƒ", sets: 3, difficultyAdjustments: { beginner: "ëª©í‘œ ìˆ˜ì‹¬ 10-15m / CO2 ì¶•ì  ëŠë‚Œ ì ì‘", intermediate: "ëª©í‘œ ìˆ˜ì‹¬ 15-25m / ìƒìŠ¹ ì‹œ CO2 ì••ë°• ê´€ë¦¬ (í•„ìš”ì‹œ ìƒìŠ¹ ì•½ê°„ ì°¸ê¸°)", advanced: "ëª©í‘œ ìˆ˜ì‹¬ 25m+ / ê°•í•œ ì»¨íŠ¸ë ‰ì…˜ ì¤‘ ê¸°ìˆ  ìœ ì§€ (í•„ìš”ì‹œ ìƒìŠ¹ ì•½ê°„ ì°¸ê¸°)" }}, { name: "CO2 CWT", _template: true, method: "ìˆ˜ë©´ ë²„í‹°ì»¬ í”¼ë‹ 30ì´ˆ í›„ ìµœì¢…í˜¸í¡, ë•ë‹¤ì´ë¹™í•˜ì—¬ ëª©í‘œ ìˆ˜ì‹¬ê¹Œì§€ CWT ìˆ˜í–‰ (ë°”ì´í•€ ì‚¬ìš©).", effect: "CWT/CWTB ê¸°ìˆ  í–¥ìƒ, CO2 ë‚´ì„± ì¦ê°€, ë‹¤ì´ë¹™ ê¸´ì¥ ì™„í™” ê¸°ìˆ  í–¥ìƒ", sets: 3, difficultyAdjustments: { beginner: "ëª©í‘œ ìˆ˜ì‹¬ 10-15m / CO2 ì¶•ì  ìƒíƒœì—ì„œ ë•ë‹¤ì´ë¹™ ë° í”¼ë‹", intermediate: "ëª©í‘œ ìˆ˜ì‹¬ 15-25m / ìƒìŠ¹ ì‹œ CO2 ì••ë°• ê´€ë¦¬ (í•„ìš”ì‹œ ìƒìŠ¹ ì•½ê°„ ì°¸ê¸°)", advanced: "ëª©í‘œ ìˆ˜ì‹¬ 25m+ / CO2 ë‚´ì„± í•œê³„ ê²½í—˜ ë° ê·¹ë³µ (í•„ìš”ì‹œ ìƒìŠ¹ ì•½ê°„ ì°¸ê¸°)" }}, { name: "CO2 CNF", _template: true, method: "ìˆ˜ë©´ ë²„í‹°ì»¬ í”¼ë‹ 30ì´ˆ í›„ ìµœì¢…í˜¸í¡, ë•ë‹¤ì´ë¹™í•˜ì—¬ ëª©í‘œ ìˆ˜ì‹¬ê¹Œì§€ CNF ìˆ˜í–‰ (ë…¸í•€ ìŠ¤í‚¬ í™œìš©).", effect: "CNF ê¸°ìˆ  í–¥ìƒ, CO2 ë‚´ì„± ì¦ê°€, ë§ˆìš°ìŠ¤í•„ ë° íƒ€ì´ë° ì¡°ì ˆ ëŠ¥ë ¥ í–¥ìƒ", sets: 3, difficultyAdjustments: { beginner: "ëª©í‘œ ìˆ˜ì‹¬ 10-15m / CO2 ì¶•ì  ìƒíƒœì—ì„œ ë…¸í•€ ë™ì‘ ìˆ˜í–‰", intermediate: "ëª©í‘œ ìˆ˜ì‹¬ 15-20m / ìƒìŠ¹ ì‹œ CO2 ì••ë°• ê´€ë¦¬ (í•„ìš”ì‹œ ìƒìŠ¹ ì•½ê°„ ì°¸ê¸°)", advanced: "ëª©í‘œ ìˆ˜ì‹¬ 20m+ / ê°•í•œ ì»¨íŠ¸ë ‰ì…˜ ì¤‘ ê¸°ìˆ  ìœ ì§€ ë° ì¡°ì ˆ (í•„ìš”ì‹œ ìƒìŠ¹ ì•½ê°„ ì°¸ê¸°)" }}, { name: "FIM -> CWT ì „í™˜ í›ˆë ¨", _template: true, method: "ê°œë°©ìˆ˜ì—­ì—ì„œ FIMìœ¼ë¡œ ëª©í‘œ ìˆ˜ì‹¬ê¹Œì§€ í•˜ê°• í›„, CWT(ë°”ì´í•€)ë¡œ ì „í™˜í•˜ì—¬ ìƒìŠ¹.", effect: "ìƒí™© ëŒ€ì²˜ ëŠ¥ë ¥, ì¢…ëª© ì „í™˜ ì ì‘ë ¥ í–¥ìƒ", sets: 2, difficultyAdjustments: { beginner: "10-15m / ë¶€ë“œëŸ¬ìš´ ì „í™˜ ì—°ìŠµ", intermediate: "15-25m / ì „í™˜ í›„ ì•ˆì •ì ì¸ ìƒìŠ¹ ì†ë„ ìœ ì§€", advanced: "25m+ / ê¹Šì€ ìˆ˜ì‹¬ì—ì„œ íš¨ìœ¨ì ì¸ ì „í™˜ ë° ìƒìŠ¹" }}, { name: "FIM -> CNF ì „í™˜ í›ˆë ¨", _template: true, method: "ê°œë°©ìˆ˜ì—­ì—ì„œ FIMìœ¼ë¡œ ëª©í‘œ ìˆ˜ì‹¬ê¹Œì§€ í•˜ê°• í›„, CNF(ë…¸í•€)ë¡œ ì „í™˜í•˜ì—¬ ìƒìŠ¹.", effect: "ìƒí™© ëŒ€ì²˜ ëŠ¥ë ¥, CNF ìƒìŠ¹ ê¸°ìˆ  ì „í™˜ ì ì‘ë ¥ í–¥ìƒ", sets: 2, difficultyAdjustments: { beginner: "10-15m / ë¶€ë“œëŸ¬ìš´ ë…¸í•€ ì „í™˜ ë° ìƒìŠ¹ ì‹œì‘ ì—°ìŠµ", intermediate: "15-20m / ì „í™˜ í›„ ì•ˆì •ì ì¸ CNF ìƒìŠ¹ ìì„¸ ë° ì†ë„ ìœ ì§€", advanced: "20m+ / ê¹Šì€ ìˆ˜ì‹¬ì—ì„œ íš¨ìœ¨ì ì¸ ë…¸í•€ ì „í™˜ ë° ìƒìŠ¹ ì»¨íŠ¸ë¡¤" }} ],
        restricted: [ { name: "ì›Œë°ì—… ìŠ¤íŠ¸ë ˆì¹­", method: "ëª©, ì–´ê¹¨, í—ˆë¦¬, ë‹¤ë¦¬ ì¤‘ì‹¬ ì „ì‹  ìŠ¤íŠ¸ë ˆì¹­", effect: "ìœ ì—°ì„± í–¥ìƒ, ë¶€ìƒ ë°©ì§€", sets: 1, duration: "10ë¶„" }, { name: "ê°€ë²¼ìš´ ìˆ˜ì˜ ì›Œë°ì—…", method: "ììœ í˜•, í‰ì˜ ë“± í¸ì•ˆí•œ ì˜ë²•ìœ¼ë¡œ", effect: "ì‹¬ë°•ìˆ˜ ìƒìŠ¹, ê·¼ìœ¡ í™œì„±í™”", distance: "100m", sets: 1 }, { name: "ìŠ¤íŠ¸ë¦¼ë¼ì¸ ê¸€ë¼ì´ë”©", method: "ë²½ ì°¨ê³  ìµœëŒ€í•œ ë©€ë¦¬ ì—ë¡œìš° ìì„¸(ìŠ¤íŠ¸ë¦¼ë¼ì¸)ë¡œ ê¸€ë¼ì´ë”©", effect: "ë¬¼ ì €í•­ ìµœì†Œí™” ìì„¸ ì—°ìŠµ, íš¨ìœ¨ì„± ì¦ëŒ€", sets: 5 }, { name: "ë‹¤ì´ë‚˜ë¯¹ í•€ í‚¥ ì—°ìŠµ (DYN)", _template: true, method: "ëª¨ë…¸í•€ ë˜ëŠ” ë°”ì´í•€ ì°©ìš© í›„ ì ì˜. í”ŒëŸ¬í„°í‚¥, ëŒí•€í‚¥ ë“±.", effect: "ìˆ˜ì¤‘ í‚¥ íš¨ìœ¨ì„± ë° ë°¸ëŸ°ìŠ¤ ê°œì„ , ì¶”ì§„ë ¥ ê°•í™”", distance: "25m+", sets: 8, difficultyAdjustments: { beginner: "ë°”ì´í•€ / ìì„¸ ìœ ì§€ ë° í‚¥ ë¦¬ë“¬ ì§‘ì¤‘ (25m)", intermediate: "ëª¨ë…¸í•€ ë˜ëŠ” ë°”ì´í•€ / ê±°ë¦¬ ì ì§„ì  ì¦ê°€ (35m+)", advanced: "ëª¨ë…¸í•€ ë˜ëŠ” ë°”ì´í•€ / ìµœì†Œ í‚¥ìœ¼ë¡œ ìµœëŒ€ ê±°ë¦¬ ëª©í‘œ (50m+)" }, tags:['fins']}, { name: "DNF í‰ì˜í‚¥ ì—°ìŠµ", method: "í•€ ì—†ì´ í‰ì˜í‚¥(Whip kick)ë§Œ ì‚¬ìš©í•˜ì—¬ ì ì˜. ê¸€ë¼ì´ë”© ê·¹ëŒ€í™”.", effect: "DNF ì¶”ì§„ë ¥ í•µì‹¬ì¸ í‰ì˜í‚¥ íš¨ìœ¨ ì¦ëŒ€", distance: "25m", sets: 4, difficultyAdjustments: { beginner: "í‚¥ íƒ€ì´ë°ê³¼ ê¸€ë¼ì´ë”© ì§‘ì¤‘", intermediate: "ìµœì†Œ í‚¥ìœ¼ë¡œ 25m ë„ë‹¬ ëª©í‘œ", advanced: "í‚¥ íŒŒì›Œ ë° ê¸€ë¼ì´ë”© ê±°ë¦¬ ê·¹ëŒ€í™” (35m+)" }, tags:['dnf', 'cnf_specific', 'kick']}, { name: "DNF ì•”ìŠ¤íŠ¸ë¡œí¬ ì—°ìŠµ", method: "í’€ë¶€ì´ ë“± ë‹¤ë¦¬ ê³ ì • í›„ íŒ”(Arm stroke)ë§Œ ì‚¬ìš©í•˜ì—¬ ì ì˜.", effect: "DNF ìƒì²´ ì¶”ì§„ë ¥ ë° ìŠ¤íŠ¸ë¦¼ë¼ì¸ ìœ ì§€ ëŠ¥ë ¥ í–¥ìƒ", distance: "25m", sets: 4, difficultyAdjustments: { beginner: "ì •í™•í•œ ìŠ¤íŠ¸ë¡œí¬ ìì„¸ ì—°ìŠµ", intermediate: "ì—°ì†ì ì¸ ìŠ¤íŠ¸ë¡œí¬ì™€ ê¸€ë¼ì´ë”© ì—°ê²°", advanced: "íŒŒì›Œí’€í•˜ê³  íš¨ìœ¨ì ì¸ ìŠ¤íŠ¸ë¡œí¬ (35m+)" }, tags:['dnf', 'cnf_specific', 'arm']}, { name: "DNF ì ì˜ (ë…¸í•€ ë‹¤ì´ë‚˜ë¯¹)", method: "ë²½ ì°¨ê¸° í›„ í‰ì˜í‚¥ê³¼ ì•”ìŠ¤íŠ¸ë¡œí¬ë¥¼ ì¡°í•©í•˜ì—¬ ì ì˜.", effect: "DNF ì¢…í•© ê¸°ìˆ , í˜‘ì‘ë ¥, ê±°ë¦¬ í–¥ìƒ", distance: "25m+", sets: 4, difficultyAdjustments: { beginner: "í‚¥/í’€/ê¸€ë¼ì´ë”© ì¡°í•© ë¦¬ë“¬ ì—°ìŠµ (25m)", intermediate: "íš¨ìœ¨ì ì¸ ì¡°í•©ìœ¼ë¡œ ê±°ë¦¬ ì¦ê°€ ì‹œë„ (35m+)", advanced: "ìµœì†Œ ìŠ¤íŠ¸ë¡œí¬/í‚¥ìœ¼ë¡œ ìµœëŒ€ ê±°ë¦¬ ëª©í‘œ (50m+)" }, tags:['dnf', 'cnf_specific']}, { name: "STA í›„ DYN/DNF ì „í™˜", method: "STA (ì •ì  ë¬´í˜¸í¡) ì‹¤ì‹œ í›„ ë°”ë¡œ DYN(í•€) ë˜ëŠ” DNF(ë…¸í•€) ìˆ˜í–‰.", effect: "ì„±ë¬¸ ì¡°ì ˆ ëŠ¥ë ¥ í–¥ìƒ, ì €ì‚°ì†Œ ìƒíƒœ ë‹¤ì´ë‚˜ë¯¹ ì ì‘", sets: 3, difficultyAdjustments: { beginner: "STA 1:00 í›„ DYN/DNF 25m", intermediate: "STA 1:30 í›„ DYN/DNF 35-40m", advanced: "STA 2:00+ í›„ DYN/DNF 50m+" }}, { name: "ì›œë‹¤ìš´ ìˆ˜ì˜", method: "í¸ì•ˆí•œ ì˜ë²•ìœ¼ë¡œ ì²œì²œíˆ ìˆ˜ì˜í•˜ë©° ì‹¬ë°•ìˆ˜ ì•ˆì •", effect: "íšŒë³µ ì´‰ì§„, ê·¼ìœ¡ ì´ì™„", distance: "100m", sets: 1 } ],
        strength: [ { name: "ìŠ¤ì¿¼íŠ¸ (Squat)", method: "í•˜ì²´ ê·¼ë ¥ ê°•í™” ê¸°ë³¸ ìš´ë™.", effect: "í•€ í‚¥ íŒŒì›Œ í–¥ìƒ, ì½”ì–´ ì•ˆì •ì„± ì¦ê°€", sets: 3, reps: "12-15íšŒ", tags: ['lower', 'core'] }, { name: "ëŸ°ì§€ (Lunge)", method: "í•œë‹¤ë¦¬ì”© ë²ˆê°ˆì•„ ì§„í–‰.", effect: "í•˜ì²´ ë¹„ëŒ€ì¹­ ê°œì„ , ë‘”ê·¼/í—ˆë²…ì§€ ê°•í™”", sets: 3, reps: "ê° ë‹¤ë¦¬ 10-12íšŒ", tags: ['lower'] }, { name: "ì¹´í”„ ë ˆì´ì¦ˆ (Calf Raise)", method: "ë°œë’¤ê¿ˆì¹˜ ë“¤ì–´ì˜¬ë ¤ ì¢…ì•„ë¦¬ ìê·¹.", effect: "ë°œëª© ì•ˆì •ì„±, í‚¥ ë§ˆë¬´ë¦¬ íŒŒì›Œ", sets: 3, reps: "20-25íšŒ", tags: ['lower'] }, { name: "í”Œë­í¬ (Plank)", method: "íŒ”ê¿ˆì¹˜/ë°œë ì§€ì§€. ì½”ì–´ í™œì„±í™”.", effect: "ì½”ì–´ ì•ˆì •ì„±, ìˆ˜ì¤‘ ìì„¸ ìœ ì§€ë ¥", sets: 3, duration: "45-75ì´ˆ", tags: ['core'] }, { name: "ë°± ìµìŠ¤í…ì…˜ (Back Extension)", method: "ì—ë“œë ¤ ìƒì²´ ë“¤ì–´ì˜¬ë ¤ ê¸°ë¦½ê·¼ ê°•í™”.", effect: "í—ˆë¦¬ ì•ˆì •ì„±, ì½”ì–´ í›„ë©´ ê°•í™”", sets: 3, reps: "15-20íšŒ", tags: ['core', 'posterior_chain'] }, { name: "ëŸ¬ì‹œì•ˆ íŠ¸ìœ„ìŠ¤íŠ¸ (Russian Twist)", method: "ì•‰ì•„ì„œ ìƒì²´ ë¹„í‹€ê¸°. ë³µì‚¬ê·¼ ê°•í™”.", effect: "ëª¸í†µ íšŒì „ ì•ˆì •ì„±, ì½”ì–´ ê°•í™”", sets: 3, reps: "20-30íšŒ (ì™•ë³µ)", tags: ['core'] }, { name: "í‘¸ì‰¬ì—… (Push-up)", method: "ê°€ìŠ´, ì–´ê¹¨, ì‚¼ë‘ê·¼ ê°•í™”.", effect: "ìƒì²´ ë¯¸ëŠ” í˜, ì½”ì–´ ë³´ì¡°", sets: 3, reps: "ìµœëŒ€ ë°˜ë³µ (8íšŒ ì´ìƒ)", tags: ['upper', 'push'] }, { name: "í’€ì—… / ë«í’€ë‹¤ìš´", method: "ë“±, ì´ë‘ê·¼ ê°•í™”. ì² ë´‰/ë¨¸ì‹  í™œìš©.", effect: "ìƒì²´ ë‹¹ê¸°ëŠ” í˜, FIM/CWT íš¨ìœ¨ì„±", sets: 3, reps: "8-12íšŒ", tags: ['upper', 'pull'] }, { name: "ë¤ë²¨ ìˆ„ë” í”„ë ˆìŠ¤", method: "ì•‰ê±°ë‚˜ ì„œì„œ ë¤ë²¨ ìœ„ë¡œ.", effect: "ì–´ê¹¨ ê·¼ë ¥, ìƒì²´ ì•ˆì •ì„±", sets: 3, reps: "10-15íšŒ", tags: ['upper', 'push'] }, { name: "ì¸í„°ë²Œ ë‹¬ë¦¬ê¸°/ì‚¬ì´í´", method: "ì§§ì€ ê³ ê°•ë„ì™€ íœ´ì‹ ë°˜ë³µ.", effect: "ì‹¬íì§€êµ¬ë ¥, ë¬´ì‚°ì†Œì„± ëŠ¥ë ¥", sets: 1, duration: "15-20ë¶„", tags: ['cardio/co2'] } ],
        dryTraining: [ { name: "ì €ì‚°ì†Œ íŠ¸ë ˆì´ë‹ (Hypoxic Training)", method: "ì €ì‚°ì†Œ ë§ˆìŠ¤í¬ ì°©ìš© ë˜ëŠ” ì½” í˜¸í¡ ì œí•œí•˜ë©° ê±·ê¸°/ê°€ë³ê²Œ ë‹¬ë¦¬ê¸°, ë˜ëŠ” ì¸í„°ë²Œ ìˆ¨ì°¸ê¸° í¬í•¨.", effect: "ì €ì‚°ì†Œ ì ì‘ë ¥ í–¥ìƒ, ì‚°ì†Œ í™œìš© íš¨ìœ¨ ì¦ëŒ€.", duration: "15-25ë¶„", sets: 1, caution: "ì ˆëŒ€ ë¬´ë¦¬ ê¸ˆì§€, ì–´ì§€ëŸ¬ì›€ ë°œìƒ ì‹œ ì¦‰ì‹œ ì¤‘ë‹¨ ë° íœ´ì‹. ë‚®ì€ ê°•ë„ë¡œ ì‹œì‘.", tags: ['dry', 'cardio/co2'] }, { name: "ì§€ì† ëŸ¬ë‹ (Continuous Run)", method: "ì¼ì •í•œ í˜ì´ìŠ¤ ìœ ì§€í•˜ë©° ì‰¬ì§€ ì•Šê³  ë‹¬ë¦¬ê¸°.", effect: "ìœ ì‚°ì†Œ ì§€êµ¬ë ¥ ë° ì‹¬í ê¸°ëŠ¥ í–¥ìƒ.", duration: "30-45ë¶„", sets: 1, difficultyAdjustments: { beginner: "20-30ë¶„, ëŒ€í™” ê°€ëŠ¥ ì†ë„", intermediate: "30-40ë¶„, ì•½ê°„ ìˆ¨ì°¬ ì†ë„", advanced: "40ë¶„ ì´ìƒ, ëª©í‘œ í˜ì´ìŠ¤ ìœ ì§€" }, tags: ['dry', 'cardio'] }, { name: "ìˆ¨ ì°¸ê³  ê±·ê¸° (Breath-hold Walk)", method: "ìµœì¢… í˜¸í¡ í›„ ìµœëŒ€í•œ ìˆ¨ ì°¸ê³  ê±·ê¸°. íœ´ì‹ í›„ ë°˜ë³µ.", effect: "COâ‚‚ ë‚´ì„± ì¦ê°€, ë¬´í˜¸í¡ ì›€ì§ì„ ì ì‘ë ¥ í–¥ìƒ.", sets: 5, duration: "ìµœëŒ€í•œ ë©€ë¦¬/ì˜¤ë˜", rest: "ì¶©ë¶„í•œ íšŒë³µ í˜¸í¡ (ìµœì†Œ 1ë¶„ 30ì´ˆ)", tags: ['dry', 'co2'] } ],
        nutrition: { general: [ { mealTime: "ì•„ì¹¨", suggestion: "ì˜¤íŠ¸ë°€ (ê·€ë¦¬) + ë² ë¦¬ë¥˜ + ê²¬ê³¼ë¥˜ í•œ ì¤Œ", focus: "ì§€ì†ì ì¸ ì—ë„ˆì§€ ê³µê¸‰" }, { mealTime: "ì ì‹¬", suggestion: "ë‹­ê°€ìŠ´ì‚´ ìƒëŸ¬ë“œ (í€´ë…¸ì•„ ë˜ëŠ” í†µê³¡ë¬¼ë¹µ) + ì˜¬ë¦¬ë¸Œ ì˜¤ì¼ ë“œë ˆì‹±", focus: "ê·¼ìœ¡ íšŒë³µ (ë‹¨ë°±ì§ˆ), ì—ë„ˆì§€ ë³´ì¶©" }, { mealTime: "ì €ë…", suggestion: "ë‘ë¶€ ì±„ì†Œ ë³¶ìŒ ë˜ëŠ” ë Œí‹¸ì½© ì¹´ë ˆ + í˜„ë¯¸ë°¥", focus: "ê· í˜•ì¡íŒ ì˜ì–‘, ê·¼ìœ¡ íšŒë³µ ì§€ì›" } ], openWater: [ { mealTime: "ì•„ì¹¨", suggestion: "í†µë°€ í† ìŠ¤íŠ¸ + ì•„ë³´ì¹´ë„ + ê³„ë€ (í›ˆë ¨ 2-3ì‹œê°„ ì „)", focus: "ì†Œí™” í¸í•œ ì—ë„ˆì§€ì›" }, { mealTime: "ì ì‹¬", suggestion: "êµ¬ìš´ ì—°ì–´ + ê³ êµ¬ë§ˆ + ë¸Œë¡œì½œë¦¬", focus: "ê¸€ë¦¬ì½”ê² ë³´ì¶©, ê·¼íšŒë³µ, í•­ì—¼" }, { mealTime: "ì €ë…", suggestion: "ì†Œê³ ê¸° ë˜ëŠ” ë‹­ê°€ìŠ´ì‚´ êµ¬ì´ + í€´ë…¸ì•„ + êµ¬ìš´ ì±„ì†Œ", focus: "ë‹¨ë°±ì§ˆ ë³´ì¶© í†µí•œ ê·¼íšŒë³µ, ë³µí•© íƒ„ìˆ˜í™”ë¬¼" } ], restricted: [ { mealTime: "ì•„ì¹¨", suggestion: "ê·¸ë¦­ ìš”ê±°íŠ¸ + ê³¼ì¼ + ê·¸ë˜ë†€ë¼ (í›ˆë ¨ 2ì‹œê°„ ì „)", focus: "ì ë‹¹ëŸ‰ ì—ë„ˆì§€, ì†Œí™” ìš©ì´" }, { mealTime: "ì ì‹¬", suggestion: "ì†Œê³ ê¸°/ë‘ë¶€ ì±„ì†Œ ë³¶ìŒ + í˜„ë¯¸ë°¥", focus: "ì² ë¶„, ë‹¨ë°±ì§ˆ, ì—ë„ˆì§€ ë³´ì¶©" }, { mealTime: "ì €ë…", suggestion: "í°ì‚´ ìƒì„ (ëŒ€êµ¬, ì¡°ê¸° ë“±) ì°œ + ì¡ê³¡ë°¥ + ë‚˜ë¬¼ ë°˜ì°¬", focus: "ì €ì§€ë°© ë‹¨ë°±ì§ˆ, ë¯¸ë„¤ë„ ë³´ì¶©, ê³¼ì‹ ë°©ì§€" } ], recovery: [ { mealTime: "ì•„ì¹¨", suggestion: "ì±„ì†Œ ìŠ¤í¬ë¨ë¸” ì—ê·¸ + í†µë°€ë¹µ 1ìª½", focus: "ë‹¨ë°±ì§ˆ, ë¹„íƒ€ë¯¼/ë¯¸ë„¤ë„ ë³´ì¶©" }, { mealTime: "ì ì‹¬", suggestion: "ë Œí‹¸ì½© ìˆ˜í”„ + ìƒëŸ¬ë“œ", focus: "ì‹ë¬¼ì„± ë‹¨ë°±ì§ˆ, ì‹ì´ì„¬ìœ , í•­ì‚°í™”" }, { mealTime: "ì €ë…", suggestion: "ë²„ì„¯ ë“¤ê¹¨íƒ• ë˜ëŠ” ì±„ì†Œ ìœ„ì£¼ ì‹ë‹¨ + ë‘ë¶€", focus: "ì˜ì–‘ ë³´ì¶© ë° ì†Œí™” ë¶€ë‹´ ì ì€ ì‹ì‚¬" } ], supplements: [ { name: "ì² ë¶„ (Iron)", effect: "í—¤ëª¨ê¸€ë¡œë¹ˆ ìƒì„± ë„ì›€, ì‚°ì†Œ ìš´ë°˜ ëŠ¥ë ¥ í–¥ìƒ ê¸°ì—¬ (ë¹ˆí˜ˆ ì˜ˆë°© ì¤‘ìš”)" }, { name: "ë§ˆê·¸ë„¤ìŠ˜ (Magnesium)", effect: "ê·¼ìœ¡ ì´ì™„ ë° ê¸°ëŠ¥ ê°œì„ , ì‹ ê²½ê³„ ì•ˆì • ë„ì›€ (ë¶€ì¡± ì‹œ ê·¼ê²½ë ¨ ìœ ë°œ ê°€ëŠ¥)" }, { name: "ì˜¤ë©”ê°€-3 (Omega-3 EPA/DHA)", effect: "ì—¼ì¦ ê°ì†Œ, ì‹¬í˜ˆê´€ ê±´ê°•, í˜ˆì•¡ ìˆœí™˜ ê°œì„  ë„ì›€ ê°€ëŠ¥ì„±" }, { name: "ë¹„íŠ¸ë£¨íŠ¸ ì£¼ìŠ¤/ì¶”ì¶œë¬¼ (Nitrates)", effect: "ì²´ë‚´ ì‚°í™”ì§ˆì†Œ(NO) ìƒì„± ì¦ê°€ì‹œì¼œ í˜ˆê´€ í™•ì¥ ë° ì‚°ì†Œ ì´ìš© íš¨ìœ¨ ì¦ëŒ€ ê°€ëŠ¥ì„±" }, { name: "ì½”ì—”ìì„ Q10 (CoQ10)", effect: "ì„¸í¬ ì—ë„ˆì§€(ATP) ìƒì„± ê³¼ì • ë³´ì¡° ë° í•­ì‚°í™” ì‘ìš©" }, { name: "ë¹„íƒ€ë¯¼ B ë³µí•©ì²´ (B-Complex)", effect: "ì—ë„ˆì§€ ëŒ€ì‚¬, ì í˜ˆêµ¬ í˜•ì„±, ì‹ ê²½ ê¸°ëŠ¥ ìœ ì§€ì— í•„ìˆ˜ì ì¸ ë¹„íƒ€ë¯¼êµ°" }, { name: "ë¹„íƒ€ë¯¼ C", effect: "í•­ì‚°í™” ì‘ìš©, ë©´ì—­ë ¥ ê°•í™”, ì½œë¼ê² ìƒì„± ë„ì›€" }, { name: "ë¹„íƒ€ë¯¼ E", effect: "ê°•ë ¥í•œ ì§€ìš©ì„± í•­ì‚°í™”ì œ, ì„¸í¬ë§‰ ë³´í˜¸" }, { name: "ì•„ë¥´ê¸°ë‹Œ / ì‹œíŠ¸ë£°ë¦°", effect: "ì‚°í™”ì§ˆì†Œ(NO) ìƒì„± ì´‰ì§„í•˜ì—¬ í˜ˆë¥˜ ê°œì„ , í”¼ë¡œ íšŒë³µ ë„ì›€ ê°€ëŠ¥ì„±" } ], generalTips: [ "ìˆ˜ë¶„ ë³´ì¶©: í›ˆë ¨ ì „í›„ ë° ì¤‘ê°„ì— ì¶©ë¶„íˆ (í•˜ë£¨ 1.5L ì´ìƒ ê¶Œì¥).", "ì‹ì‚¬ ì‹œê°„: ìˆ˜ì¤‘ í›ˆë ¨ ìµœì†Œ 2-3ì‹œê°„ ì „ ì‹ì‚¬ ì™„ë£Œ.", "ê°€ê³µì‹í’ˆ ì¤„ì´ê¸°: ì •ì œ ì„¤íƒ•, íŠ¸ëœìŠ¤ ì§€ë°© í”¼í•˜ê¸°.", "ë‹¤ì–‘ì„±: ë‹¤ì–‘í•œ ì±„ì†Œ/ê³¼ì¼, í†µê³¡ë¬¼, ë‹¨ë°±ì§ˆ ì„­ì·¨.", "ê°œì¸í™”: ëª¸ ìƒíƒœì™€ ì†Œí™” ëŠ¥ë ¥ì— ë§ì¶° ì¡°ì ˆ, í•„ìš”ì‹œ ì „ë¬¸ê°€ ìƒë‹´.", "**ì£¼ì˜:** ì˜ì–‘ì œ/ë³´ì¶©ì œëŠ” ë³´ì¡° ìˆ˜ë‹¨ì´ë©°, ê· í˜• ì¡íŒ ì‹ë‹¨ì„ ëŒ€ì²´í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤. íŠ¹ì • ì§ˆí™˜ì´ ìˆê±°ë‚˜ ì•½ë¬¼ì„ ë³µìš© ì¤‘ì¸ ê²½ìš°, ì„­ì·¨ ì „ ë°˜ë“œì‹œ ì˜ì‚¬ ë˜ëŠ” ì•½ì‚¬ì™€ ìƒë‹´í•˜ì„¸ìš”." ] }
    };

    // --- Helper Functions ---
    function deepCopy(obj) { try { return JSON.parse(JSON.stringify(obj)); } catch (e) { console.error("Deep copy failed:", e, obj); return obj; } }
    function getRandomItems(array, count) { if (!Array.isArray(array)) { console.warn("getRandomItems received non-array input:", array); return []; } if (array.length === 0 || count <= 0) return []; try { const copiedArray = deepCopy(array); const shuffled = copiedArray.sort(() => 0.5 - Math.random()); return deepCopy(shuffled.slice(0, Math.min(count, shuffled.length))); } catch (error) { console.error("Error during getRandomItems:", error); return []; } }
    function sanitizeForId(str) { if (typeof str !== 'string') return ''; return str.toLowerCase().replace(/[^a-z0-9\-]/g, '-').replace(/^-+|-+$/g, '').replace(/-{2,}/g, '-'); }
    function getNumericInput(id) { try { const input = document.getElementById(id); if (!input) return 0; const value = parseInt(input.value, 10); return !isNaN(value) && value > 0 ? value : 0; } catch (error) { console.error(`Error in getNumericInput for ID '${id}':`, error); return 0; } }

    // --- Update Experience Level ---
    function updateExperienceLevel() { try { const targetRecordInput = document.getElementById('targetRecord'); const experienceLevelSelect = document.getElementById('experienceLevel'); if (!targetRecordInput || !experienceLevelSelect) return; const targetDepth = parseInt(targetRecordInput.value, 10); if (!isNaN(targetDepth) && targetDepth > 0) { let newLevel = 'beginner'; if (targetDepth > 45) newLevel = 'advanced'; else if (targetDepth > 25) newLevel = 'intermediate'; if (experienceLevelSelect.value !== newLevel) experienceLevelSelect.value = newLevel; } } catch (error) { console.error("Error inside updateExperienceLevel:", error); } }

    // --- Schedule Generation Wrapper ---
    function generateScheduleWrapper() { console.log("generateScheduleWrapper called"); showLoader("ìŠ¤ì¼€ì¤„ ìƒì„± ì¤‘..."); setTimeout(() => { try { generateSchedule(); console.log("generateSchedule completed successfully (within wrapper)."); } catch (error) { console.error("Error caught in generateScheduleWrapper:", error.message); alert(`ìŠ¤ì¼€ì¤„ ìƒì„± ì¤‘ ì˜¤ë¥˜ ë°œìƒ:\n${error.message}\n\nìì„¸í•œ ë‚´ìš©ì€ ê°œë°œì ì½˜ì†”(F12)ì„ í™•ì¸í•˜ì„¸ìš”.`); } finally { hideLoader(); console.log("Loader hidden."); } }, 10); }

    // --- Main Schedule Generation Logic ---
    function generateSchedule() {
        console.log("--- generateSchedule started ---");
        console.log("Reading inputs..."); const userName = document.getElementById('userName')?.value.trim() || "ì‚¬ìš©ì"; const targetDiscipline = document.getElementById('targetDiscipline')?.value || 'CWT'; const currentPb = getNumericInput('currentPb'); const targetRecord = getNumericInput('targetRecord'); const days = getNumericInput('trainingDays') || 14; const includeNutrition = document.getElementById('includeNutrition')?.value === 'yes'; const includeExplanations = document.getElementById('includeExplanations')?.value === 'yes'; const selectedTrainingTypes = Array.from(document.querySelectorAll('input[name="trainingType"]:checked')).map(cb => cb.value); const isRestrictedSelected = selectedTrainingTypes.includes('restricted');
        console.log("Performing validation..."); if (targetRecord <= 0) { document.getElementById('targetRecord')?.focus(); throw new Error("ìœ íš¨í•œ ëª©í‘œ ìˆ˜ì‹¬(m)ì„ ì…ë ¥í•´ì£¼ì„¸ìš”."); } if (currentPb <= 0) { document.getElementById('currentPb')?.focus(); throw new Error("ìœ íš¨í•œ í˜„ì¬ PB(m)ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”."); } if (currentPb >= targetRecord) { document.getElementById('targetRecord')?.focus(); throw new Error("ëª©í‘œ ìˆ˜ì‹¬ì€ í˜„ì¬ PBë³´ë‹¤ ê¹Šì–´ì•¼ í•©ë‹ˆë‹¤."); } if (days <= 0) { document.getElementById('trainingDays')?.focus(); throw new Error("ìœ íš¨í•œ íŠ¸ë ˆì´ë‹ ê¸°ê°„ì„ ì„ íƒí•´ì£¼ì„¸ìš”."); } console.log("Validation passed.");
        console.log("Updating and reading experience level..."); updateExperienceLevel(); const level = document.getElementById('experienceLevel')?.value || 'beginner'; console.log(`Inputs Confirmed: User=${userName}, Discipline=${targetDiscipline}, PB=${currentPb}, Target=${targetRecord}, Level=${level}, Days=${days}, SelectedTypes=${selectedTrainingTypes.join(',')}, RestrictedSelected=${isRestrictedSelected}`);
        console.log("Updating subtitle and clearing outputs..."); const subTitleElement = document.getElementById('subTitle'); if (subTitleElement) subTitleElement.textContent = `${userName}ë‹˜ì˜ ${targetDiscipline} ${currentPb}m -> ${targetRecord}m ë„ì „ì„ ìœ„í•œ ë§ì¶¤ ê³„íš`; const scheduleContainer = document.getElementById('scheduleContainer'); const nutritionTipsContainer = document.getElementById('generalNutritionTipsContainer'); const precautionsContainer = document.getElementById('trainingPrecautionsContainer'); if (!scheduleContainer || !precautionsContainer || !nutritionTipsContainer) { throw new Error("FATAL: í•„ìˆ˜ ì»¨í…Œì´ë„ˆ ìš”ì†Œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤ (schedule, precautions, nutrition)."); } scheduleContainer.innerHTML = ''; if (nutritionTipsContainer) nutritionTipsContainer.innerHTML = ''; if (precautionsContainer) precautionsContainer.innerHTML = ''; scheduleContainer.className = 'grid'; console.log("Outputs cleared.");

        // Display Training Precautions
        console.log("Displaying training precautions..."); if (precautionsContainer) { precautionsContainer.style.display = 'block'; const precautionsTitle = document.createElement('h4'); precautionsTitle.textContent = 'ğŸš¨ í”„ë¦¬ë‹¤ì´ë¹™ í›ˆë ¨ ì£¼ì˜ì‚¬í•­'; precautionsContainer.appendChild(precautionsTitle); const precautionsList = document.createElement('ul'); const precautions = [ "ì ˆëŒ€ í˜¼ì ë‹¤ì´ë¹™í•˜ì§€ ë§ˆì„¸ìš”. í•­ìƒ ìê²©ì„ ê°–ì¶˜ ë²„ë””ì™€ í•¨ê»˜ í•˜ì„¸ìš”.", "ëª¸ì˜ ì†Œë¦¬ì— ê·€ ê¸°ìš¸ì´ì„¸ìš”. í”¼ê³¤í•˜ê±°ë‚˜ ì»¨ë””ì…˜ì´ ì¢‹ì§€ ì•Šë‹¤ë©´ ì ˆëŒ€ ë¬´ë¦¬í•˜ì§€ ë§ˆì„¸ìš”.", "ì´í€„ë¼ì´ì§•(ì••ë ¥ í‰í˜•)ì€ ë¶€ë“œëŸ½ê²Œ, ë¯¸ë¦¬ ìˆ˜í–‰í•˜ì„¸ìš”. í†µì¦ì„ ëŠë¼ë©´ ì¦‰ì‹œ ìƒìŠ¹í•˜ì„¸ìš”.", "ê³¼í˜¸í¡(Hyperventilation)ì€ ìœ„í—˜í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ìê²©ì„ ê°–ì¶˜ ê°•ì‚¬ì˜ ì§€ë„ ì—†ì´ ê³¼ë„í•˜ê²Œ ì‹œë„í•˜ì§€ ë§ˆì„¸ìš”.", "ì¶œìˆ˜ í›„ íšŒë³µ í˜¸í¡(Recovery Breathing) ì ˆì°¨ë¥¼ ë°˜ë“œì‹œ ì§€í‚¤ì„¸ìš”.", "ì ì§„ì ìœ¼ë¡œ ìˆ˜ì‹¬ê³¼ ì‹œê°„ì„ ëŠ˜ë ¤ê°€ì„¸ìš”. ê¸‰ê²©í•œ ì¦ê°€ëŠ” ìœ„í—˜í•©ë‹ˆë‹¤.", "ì ì ˆí•œ ì›¨ì´íŠ¸(Weighting)ë¥¼ ì°©ìš©í•˜ê³  ì¤‘ì„± ë¶€ë ¥ì„ ì •í™•íˆ í™•ì¸í•˜ì„¸ìš”.", "ìì‹ ì˜ í•œê³„ë¥¼ ì¸ì§€í•˜ê³  ì ˆëŒ€ ë¬´ì‹œí•˜ì§€ ë§ˆì„¸ìš”. (ë¶ˆì•ˆê°, ì¶”ìœ„ ë“±)", "í›ˆë ¨ ì „í›„ ì¶©ë¶„í•œ íœ´ì‹ì„ ì·¨í•˜ê³  ìˆ˜ë¶„ì„ ë³´ì¶©í•˜ì„¸ìš”.", "ê³µì¸ëœ ê¸°ê´€ì˜ ìê²©ì„ ê°–ì¶˜ ê°•ì‚¬ì—ê²Œ êµìœ¡ì„ ë°›ìœ¼ì„¸ìš”.", "ìˆ˜ì˜¨, ì¡°ë¥˜, ì‹œì•¼ ë“± í•´ì–‘ í™˜ê²½ ì¡°ê±´ì„ í•­ìƒ í™•ì¸í•˜ê³  ì•ˆì „ì„ ìµœìš°ì„ ìœ¼ë¡œ í•˜ì„¸ìš”." ]; precautions.forEach(tip => { const tipLi = document.createElement('li'); tipLi.textContent = tip; precautionsList.appendChild(tipLi); }); precautionsContainer.appendChild(precautionsList); } else { console.warn("Training precautions container not found"); }
        // Display Nutrition Tips
        if (includeNutrition && data.nutrition?.generalTips) { console.log("Displaying general nutrition tips..."); if (nutritionTipsContainer) { nutritionTipsContainer.style.display = 'block'; const tipsTitle = document.createElement('h4'); tipsTitle.textContent = 'ì¼ë°˜ ì˜ì–‘ íŒ'; nutritionTipsContainer.appendChild(tipsTitle); const tipsList = document.createElement('ul'); data.nutrition.generalTips.forEach(tip => { const tipLi = document.createElement('li'); tipLi.innerHTML = tip.startsWith("**ì£¼ì˜:**") ? `<strong style="color:#B91C1C;">${tip}</strong>` : tip; tipsList.appendChild(tipLi); }); nutritionTipsContainer.appendChild(tipsList); } } else { if (nutritionTipsContainer) nutritionTipsContainer.style.display = 'none'; }

        // Determine Open Water Days & Counters
        console.log("Determining open water days pattern..."); const openWaterDayPattern = [2]; let totalOpenWaterDays = 0; if (selectedTrainingTypes.includes('openWater')) { const cycleLength = isRestrictedSelected ? 4 : 3; const owCycleDays = isRestrictedSelected ? openWaterDayPattern : [1, 2]; for (let dayIndex = 1; dayIndex <= days; dayIndex++) { const cycleDay = dayIndex % cycleLength; if(cycleLength === 3 && cycleDay === 0) continue; if (cycleDay !== 0 && owCycleDays.includes(cycleDay)) totalOpenWaterDays++; } } console.log("Calculated total Open Water Days:", totalOpenWaterDays); const depthIncrease = targetRecord - currentPb; let openWaterDayCounter = 0; let currentIntermediateTargetPb = currentPb; let dryDayCounter = 0; let restrictedDayCounter = 0;

        // --- Generate Daily Cards ---
        console.log(`--- Starting daily card generation loop for ${days} days (Restricted Selected: ${isRestrictedSelected}) ---`);
        for (let i = 1; i <= days; i++) {
            console.log(`\nProcessing Day ${i}...`); const card = document.createElement('div'); card.className = 'schedule-card'; const title = document.createElement('div'); title.className = 'day-title'; const content = document.createElement('div'); content.className = 'card-content'; let exercisesAdded = false; let dayTypeName = ""; let nutritionPlanKey = 'general'; let isDryDay = false; let isRestrictedDay = false; let isOpenWaterDay = false; let addedCategories = [];
            const cycleLength = isRestrictedSelected ? 4 : 3; const cycleDay = i % cycleLength === 0 ? cycleLength : i % cycleLength;

            if ((isRestrictedSelected && cycleDay === 4) || (!isRestrictedSelected && cycleDay === 3)) { isDryDay = true; dayTypeName = "ë“œë¼ì´ ë°ì´"; nutritionPlanKey = data.nutrition?.recovery ? 'recovery' : 'general'; title.classList.add('dry-day'); console.log(`  Type: Dry Day (${cycleLength}-day cycle)`); }
            else if (isRestrictedSelected) { if (cycleDay === 1 || cycleDay === 3) { isRestrictedDay = true; dayTypeName = "ì œí•œìˆ˜ì—­ í›ˆë ¨"; nutritionPlanKey = data.nutrition?.restricted ? 'restricted' : 'general'; title.classList.add("restricted-day-title"); addedCategories.push("ì œí•œìˆ˜ì—­"); console.log(`  Type: Restricted Water Day (4-day cycle)`); } else { isOpenWaterDay = true; dayTypeName = "ê°œë°©ìˆ˜ì—­ í›ˆë ¨"; nutritionPlanKey = data.nutrition?.openWater ? 'openWater' : 'general'; title.classList.add("openwater-day-title"); addedCategories.push("ê°œë°©ìˆ˜ì—­"); console.log(`  Type: Open Water Day (4-day cycle)`); } }
            else { isOpenWaterDay = true; dayTypeName = "ê°œë°©ìˆ˜ì—­ í›ˆë ¨"; nutritionPlanKey = data.nutrition?.openWater ? 'openWater' : 'general'; title.classList.add("openwater-day-title"); addedCategories.push("ê°œë°©ìˆ˜ì—­"); console.log(`  Type: Open Water Day (3-day cycle)`); }

            try {
                if (isDryDay) { dryDayCounter++; if (data.dryTraining?.length > 0) { const dryTrainIndex = (dryDayCounter - 1) % data.dryTraining.length; if (dryTrainIndex >= 0 && dryTrainIndex < data.dryTraining.length) { const selectedDryTraining = [ deepCopy(data.dryTraining[dryTrainIndex]) ]; console.log(`  Adding Dry Training:`, selectedDryTraining.map(e=>e.name)); addCategoryAndExercises(content, 'ë“œë¼ì´ íŠ¸ë ˆì´ë‹', selectedDryTraining, includeExplanations, level, i); exercisesAdded = true; } } }
                else {
                    console.log(`  Processing Training Day Content...`);
                    if (selectedTrainingTypes.includes('breath') && data.breath?.length > 0) { const items = getRandomItems(data.breath, level === 'beginner' ? 1 : 2); if(items?.length > 0){ console.log(`  Adding Breath (${items.length})`); addCategoryAndExercises(content, 'í˜¸í¡ í›ˆë ¨', items, includeExplanations, level, i); exercisesAdded = true; if (!addedCategories.includes("í˜¸í¡")) addedCategories.push("í˜¸í¡"); }}
                    // ******** Updated Pressure Selection Logic ********
                    if (selectedTrainingTypes.includes('pressure') && data.pressure?.length > 0) { const numPressureExercises = level === 'beginner' ? 1 : 2; let pressureExercises = getRandomItems(data.pressure, numPressureExercises); if (pressureExercises?.length > 0) { console.log(`  Adding Pressure (${pressureExercises.length}):`, pressureExercises.map(e=>e.name)); addCategoryAndExercises(content, 'ì••ë ¥í‰í˜• í›ˆë ¨', pressureExercises, includeExplanations, level, i); exercisesAdded = true; if (!addedCategories.includes("ì••ë ¥í‰í˜•")) addedCategories.push("ì••ë ¥í‰í˜•"); } else { console.warn("  No pressure exercises selected."); } }
                    // ******** END Updated Pressure Selection Logic ********
                    if (isRestrictedDay && data.restricted?.length > 0) { restrictedDayCounter++; console.log(`  Adding Restricted Water Content (Cycle ${restrictedDayCounter})`); let restrictedExercises = buildRestrictedExercises(targetDiscipline, level); if (restrictedExercises?.length > 0) { addCategoryAndExercises(content, `ì œí•œìˆ˜ì—­ (${targetDiscipline} íŠ¹í™”)`, restrictedExercises, includeExplanations, level, i); exercisesAdded = true; } }
                    if (isOpenWaterDay && selectedTrainingTypes.includes('openWater') && data.openWater?.length > 0) { openWaterDayCounter++; console.log(`  Adding Open Water Content (Cycle ${openWaterDayCounter})`); let openWaterExercises = buildOpenWaterExercises(targetDiscipline, level, openWaterDayCounter, totalOpenWaterDays, currentPb, targetRecord, userName); const pbDive = openWaterExercises.find(ex => ex.name.includes("ëª©í‘œ: ~")); if(pbDive && pbDive.name.match(/~(\d+)m/)){ currentIntermediateTargetPb = parseInt(pbDive.name.match(/~(\d+)m/)[1], 10); } else { currentIntermediateTargetPb = currentPb; } if (openWaterExercises?.length > 0) { addCategoryAndExercises(content, `ê°œë°©ìˆ˜ì—­ (${targetDiscipline})`, openWaterExercises, includeExplanations, level, i); exercisesAdded = true; } }
                    if (selectedTrainingTypes.includes('strength') && data.strength?.length > 0) { let strengthFocus = ''; let focusTags = []; const actualTrainingDayIndex = i - Math.floor((i-1)/cycleLength); const focusCycle = (actualTrainingDayIndex - 1) % 3; if (focusCycle === 0) { strengthFocus = 'í•˜ì²´ & ì½”ì–´'; focusTags = ['lower', 'core']; } else if (focusCycle === 1) { strengthFocus = 'ìƒì²´ (Push & Pull)'; focusTags = ['push', 'pull']; } else { strengthFocus = 'ì½”ì–´ & Cardio/CO2'; focusTags = ['core', 'cardio/co2', 'posterior_chain']; } const allStrengthExercises = deepCopy(data.strength); const relevantExercises = Array.isArray(allStrengthExercises) ? allStrengthExercises.filter(ex => focusTags.some(tag => ex.tags?.includes(tag))) : []; let prioritizedExercise = null; if (targetDiscipline === 'FIM' && focusTags.includes('pull')) prioritizedExercise = relevantExercises.find(ex => ex.name.includes('í’€ì—…') || ex.name.includes('ë«í’€ë‹¤ìš´')); else if ((targetDiscipline === 'CWT' || targetDiscipline === 'CWTB') && focusTags.includes('lower')) prioritizedExercise = relevantExercises.find(ex => ex.name.includes('ìŠ¤ì¿¼íŠ¸') || ex.name.includes('ëŸ°ì§€')); else if (focusTags.includes('core')) prioritizedExercise = relevantExercises.find(ex => ex.name.includes('í”Œë­í¬')); let strengthExercises = []; const numStrengthExercises = (level === 'beginner') ? 1 : 2; if (prioritizedExercise) { strengthExercises.push(prioritizedExercise); const remaining = relevantExercises.filter(ex => ex.name !== prioritizedExercise.name); if (Array.isArray(remaining)) { strengthExercises.push(...getRandomItems(remaining, Math.max(0, numStrengthExercises - 1))); } } else { if(Array.isArray(relevantExercises)) strengthExercises = getRandomItems(relevantExercises, numStrengthExercises); } strengthExercises = [...new Map(strengthExercises.map(item => [item.name, item])).values()]; if (strengthExercises.length > 0) { console.log(`  Adding Strength (${strengthExercises.length}) - Focus: ${strengthFocus}`); addCategoryAndExercises(content, `ì²´ë ¥ í›ˆë ¨ - ${strengthFocus}`, strengthExercises, includeExplanations, level, i); exercisesAdded = true; if (!addedCategories.includes("ì²´ë ¥")) addedCategories.push("ì²´ë ¥"); } else { console.warn(`  No strength exercises selected for focus: ${strengthFocus}`); } }
                    // Set Title
                    if (addedCategories.length > 0) { dayTypeName = addedCategories.join(' & ') + " í›ˆë ¨"; } else if (exercisesAdded) { dayTypeName = "ì§€ìƒ í›ˆë ¨"; } else { dayTypeName = "íœ´ì‹ ë˜ëŠ” ììœ¨ í›ˆë ¨"; } title.textContent = `DAY ${i} - ${dayTypeName}`;
                } // End Training Day

                if (!exercisesAdded) { /* Placeholder */ console.log(`  No exercises added for Day ${i}.`); const noExerciseInfo = document.createElement('p'); noExerciseInfo.textContent = 'ì´ ë‚ ì§œì— í•´ë‹¹í•˜ëŠ” í›ˆë ¨ì´ ì—†ê±°ë‚˜ ì„ íƒë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.'; noExerciseInfo.style.fontStyle = 'italic'; noExerciseInfo.style.color = '#666'; content.appendChild(noExerciseInfo); }
                if (includeNutrition && data.nutrition) { /* Add nutrition */ console.log(`  Adding Nutrition Plan (Key: ${nutritionPlanKey})`); addNutritionPlan(content, nutritionPlanKey, includeExplanations); }

                card.appendChild(title); card.appendChild(content); console.log(`  Appending card for Day ${i}`); scheduleContainer.appendChild(card);
            } catch (dayError) { console.error(`Error processing Day ${i}:`, dayError); /* Handle error display */ const errorMsg = document.createElement('p'); errorMsg.textContent = `[ì˜¤ë¥˜ ë°œìƒ: ${dayError.message}]`; errorMsg.style.color = 'red'; errorMsg.style.fontWeight = 'bold'; content.appendChild(errorMsg); if (!title.parentNode) card.appendChild(title); if (!content.parentNode) card.appendChild(content); scheduleContainer.appendChild(card); }
        }
        console.log("--- Schedule generation loop finished ---");
    } // End generateSchedule

    // --- Helper: Build Restricted Exercises ---
    function buildRestrictedExercises(targetDiscipline, level) {
        let exercises = [];
        if (!Array.isArray(data.restricted)) { console.error("buildRestrictedExercises: data.restricted is not an array!"); return exercises; }
        const warmupItems = data.restricted.filter(ex => ex.name.includes("ì›Œë°ì—…") || ex.name.includes("ìŠ¤íŠ¸ë ˆì¹­")); exercises.push(...deepCopy(warmupItems));
        const streamline = data.restricted.find(ex => ex.name.includes("ìŠ¤íŠ¸ë¦¼ë¼ì¸")); if(streamline) exercises.push(deepCopy(streamline));

        if (targetDiscipline === 'CNF') {
            const cnfPoolDrills = data.restricted.filter(ex => ex.tags?.includes('cnf_specific'));
            if (cnfPoolDrills?.length > 0) exercises.push(...getRandomItems(cnfPoolDrills, 2));
        } else {
            const dynType = (targetDiscipline === 'CWTB' || level === 'beginner') ? 'ë°”ì´í•€' : 'ëª¨ë…¸í•€';
            const dynTemplate = data.restricted.find(ex => ex._template && ex.name.includes("ë‹¤ì´ë‚˜ë¯¹ í•€ í‚¥ ì—°ìŠµ"));
            if(dynTemplate){ let dynCopy = deepCopy(dynTemplate); dynCopy.name = `DYN (${dynType}) ì—°ìŠµ`; dynCopy.method = `${dynType} ì°©ìš© í›„ ì ì˜. ìì„¸, í‚¥ íš¨ìœ¨ì„±, í„´ ì§‘ì¤‘.`; delete dynCopy._template; exercises.push(dynCopy); } else { console.warn("DYN template not found"); }
        }
        if (level !== 'beginner'){
            const staTransition = data.restricted.find(ex => ex.name.includes("STA í›„ DYN/DNF ì „í™˜"));
            if(staTransition) exercises.push(deepCopy(staTransition)); else { console.warn("STA í›„ DYN/DNF ì „í™˜ exercise not found."); }
        }
        const cooldown = data.restricted.find(ex => ex.name.includes("ì›œë‹¤ìš´"));
        if (cooldown) exercises.push(deepCopy(cooldown)); else { console.warn("ì›œë‹¤ìš´ ìˆ˜ì˜ exercise not found."); }

        return Array.isArray(exercises) ? [...new Map(exercises.map(item => [item.name, item])).values()] : [];
    }
    // --- Helper: Build Open Water Exercises ---
    function buildOpenWaterExercises(targetDiscipline, level, openWaterDayCounter, totalOpenWaterDays, currentPb, targetRecord, userName) {
        let exercises = [];
        if (!Array.isArray(data.openWater)) { console.error("buildOpenWaterExercises: data.openWater is not an array!"); return exercises; }
        let currentIntermediateTargetPb = currentPb; const depthIncrease = targetRecord - currentPb;
        const allOpenWaterTemplates = deepCopy(data.openWater.filter(ex => ex._template));
        const specificDrills = deepCopy(data.openWater.filter(ex => !ex._template && !ex.name.includes("ì „í™˜ í›ˆë ¨")));

        // 1. Add Warmup
        const fimWarmupTemplate = allOpenWaterTemplates.find(ex => ex.name.includes("í”„ë¦¬ì´ë©€ì…˜"));
        if (fimWarmupTemplate) { /* adjust & add */ let fimWarmup = deepCopy(fimWarmupTemplate); let fimTargetDepth = Math.round(currentPb * 0.4); if (level === 'advanced') fimTargetDepth = Math.min(25, Math.round(currentPb * 0.5)); else if (level === 'intermediate') fimTargetDepth = Math.min(20, Math.round(currentPb * 0.45)); fimTargetDepth = Math.max(10, fimTargetDepth); let fimTargetRange = `${fimTargetDepth - 3}-${fimTargetDepth}m`; if(fimWarmup.difficultyAdjustments?.[level]){ const effectText = fimWarmup.difficultyAdjustments[level].split('/')[1]?.trim() || 'ì›Œë°ì—… ë° ë¶€ë ¥ ì²´í¬'; fimWarmup.difficultyAdjustments[level] = `${fimTargetRange} / ${effectText}`; } else { if(!fimWarmup.difficultyAdjustments) fimWarmup.difficultyAdjustments = {}; fimWarmup.difficultyAdjustments[level] = `${fimTargetRange} / ì›Œë°ì—… ë° ë¶€ë ¥ ì²´í¬`; } delete fimWarmup._template; exercises.push(fimWarmup); } else { console.warn("FIM Warmup template not found in data.openWater"); }

        // 2. Add PB Dive
        if (level !== 'beginner') { const pbDiveTemplate = allOpenWaterTemplates.find(ex => ex.name.includes("PB ë‹¤ì´ë¹™")); if (pbDiveTemplate) { let pbDive = deepCopy(pbDiveTemplate); let intermediateTarget = currentPb + 1; if (totalOpenWaterDays > 0 && depthIncrease > 0) { const increment = Math.ceil(depthIncrease / (totalOpenWaterDays || 1)); intermediateTarget = currentPb + (increment * openWaterDayCounter); } currentIntermediateTargetPb = Math.min(targetRecord, Math.max(currentPb + 1, intermediateTarget)); pbDive.name = `${userName} ${targetDiscipline} Day ${openWaterDayCounter} ëª©í‘œ: ~${currentIntermediateTargetPb}m`; pbDive.method = `ì¶©ë¶„í•œ ì›Œë°ì—… í›„, ${targetDiscipline}ìœ¼ë¡œ ê¸ˆì¼ ëª©í‘œ ìˆ˜ì‹¬(${currentIntermediateTargetPb}m) ë„ì „ (1íšŒ). ì•ˆì „ ì ˆì°¨ ì—„ìˆ˜. (ìµœì¢… ëª©í‘œ: ${targetRecord}m)`; delete pbDive.difficultyAdjustments; delete pbDive._template; exercises.push(pbDive); } else { console.warn("PB Dive template not found in data.openWater"); } }

        // 3. Add CO2 Dive
        if (level !== 'beginner') { let co2DiveType = 'CO2 CWT'; if (targetDiscipline === 'FIM') co2DiveType = 'CO2 FIM'; else if (targetDiscipline === 'CNF') co2DiveType = 'CO2 CNF'; const co2DiveTemplate = allOpenWaterTemplates.find(ex => ex.name === co2DiveType); if (co2DiveTemplate) { let co2Dive = deepCopy(co2DiveTemplate); let baseDepthForCO2 = currentIntermediateTargetPb > currentPb ? currentIntermediateTargetPb : currentPb; let co2TargetDepth = Math.round(baseDepthForCO2 * 0.6); if (level === 'intermediate') co2TargetDepth = Math.min(25, co2TargetDepth); else if (level === 'advanced') co2TargetDepth = Math.min(35, co2TargetDepth); co2TargetDepth = Math.max(15, co2TargetDepth); let co2TargetRange = `${Math.max(15, Math.round(co2TargetDepth * 0.8))}-${co2TargetDepth}m`; if(co2Dive.difficultyAdjustments?.[level]){ const effectText = co2Dive.difficultyAdjustments[level].split('/')[1]?.trim() || 'CO2 ë‚´ì„± í›ˆë ¨'; co2Dive.difficultyAdjustments[level] = `${co2TargetRange} / ${effectText}`; } else { if(!co2Dive.difficultyAdjustments) co2Dive.difficultyAdjustments = {}; co2Dive.difficultyAdjustments[level] = `${co2TargetRange} / CO2 ë‚´ì„± í›ˆë ¨`; } delete co2Dive._template; exercises.push(co2Dive); } else { console.warn(`${co2DiveType} template not found in data.openWater`); } }

        // 4. Add Transition Drill
        let transitionDrillTemplate = null;
        if (targetDiscipline === 'CNF') { transitionDrillTemplate = allOpenWaterTemplates.find(ex => ex.name.includes("FIM -> CNF ì „í™˜")); }
        else { transitionDrillTemplate = allOpenWaterTemplates.find(ex => ex.name.includes("FIM -> CWT ì „í™˜")); }
        if (transitionDrillTemplate) { let transitionDrill = deepCopy(transitionDrillTemplate); delete transitionDrill._template; exercises.push(transitionDrill); } else { console.warn("Appropriate transition drill template not found"); }

        return Array.isArray(exercises) ? [...new Map(exercises.map(item => [item.name, item])).values()] : [];
    }

    // --- Add Exercise Category and Content (ë‚œì´ë„ ì œì•ˆ ìˆ˜ì •ë¨) ---
    function addCategoryAndExercises(container, categoryName, exercises, includeExplanations, level, dayNum) {
        if (!container || !Array.isArray(exercises) || exercises.length === 0) return;
        const categoryDiv = document.createElement('div'); categoryDiv.className = 'exercise-category'; categoryDiv.textContent = categoryName; container.appendChild(categoryDiv);
        const list = document.createElement('ul'); list.className = 'list-disc';
        exercises.forEach((ex, index) => {
             if (!ex || typeof ex !== 'object' || !ex.name) { console.warn("Skipping invalid exercise object in addCategory:", ex); return; }
             const li = document.createElement('li'); const sanitizedCategoryName = sanitizeForId(categoryName); const checkboxId = `ex-d${dayNum}-${sanitizedCategoryName}-${index}`;
             const label = document.createElement('label'); label.htmlFor = checkboxId;
             const checkbox = document.createElement('input'); checkbox.type = 'checkbox'; checkbox.id = checkboxId; checkbox.className = 'exercise-checkbox';
             const textSpan = document.createElement('span'); textSpan.className = 'exercise-text'; let baseText = ex.name; if (ex.sets) baseText += ` <span class="sets">${ex.sets}ì„¸íŠ¸</span>`; if (ex.reps) baseText += ` <span class="duration">${ex.reps}</span>`; if (ex.distance) baseText += ` <span class="duration">${ex.distance}</span>`; if (ex.duration && !ex.reps && !ex.distance) baseText += ` <span class="duration">${ex.duration}</span>`; textSpan.innerHTML = baseText; label.appendChild(checkbox); label.appendChild(textSpan); li.appendChild(label);
             if (includeExplanations) {
                 const detailsDiv = document.createElement('div'); detailsDiv.className = 'exercise-details'; let detailsContent = '';
                 if (ex.method) detailsContent += `<div class='exercise-info'>${ex.method}${ex.effect ? ` â€“ ${ex.effect}` : ''}</div>`; else if (ex.effect) detailsContent += `<div class='exercise-info'>íš¨ê³¼: ${ex.effect}</div>`;
                 const difficultyText = ex.difficultyAdjustments?.[level];
                 if (difficultyText) {
                     const levelDisplay = level.charAt(0).toUpperCase() + level.slice(1);
                     detailsContent += `<div class='difficulty-info'><strong>[${levelDisplay} ë ˆë²¨]</strong> ${difficultyText}</div>`;
                 } else { /* console.log(`  - Difficulty adjustment for level '${level}' not found for exercise: ${ex.name}`); */ } // ì •ë³´ ì—†ìœ¼ë©´ í‘œì‹œ ì•ˆí•¨
                 if (ex.caution) detailsContent += `<div class='caution'><strong>ì£¼ì˜:</strong> ${ex.caution}</div>`; if (ex.rest) detailsContent += `<div class='exercise-info'>íœ´ì‹: ${ex.rest}</div>`; if (detailsContent) { detailsDiv.innerHTML = detailsContent; li.appendChild(detailsDiv); }
             } list.appendChild(li);
        });
        if (list.children.length > 0) container.appendChild(list);
    }
    // --- Add Nutrition Plan (ë™ì¼) ---
    function addNutritionPlan(container, planKey, includeExplanations) { if (!container || !data.nutrition) { return;} const mealPlan = data.nutrition[planKey] || data.nutrition.general || []; const supplements = data.nutrition.supplements || []; if (mealPlan.length === 0 && supplements.length === 0) { return; } const nutritionCategory = document.createElement('div'); nutritionCategory.className = 'nutrition-category'; nutritionCategory.textContent = 'ì˜ì–‘ ê³„íš (ì‹ì‚¬ & ë³´ì¶©ì œ)'; container.appendChild(nutritionCategory); const nutritionContent = document.createElement('div'); if (mealPlan.length > 0) { mealPlan.forEach(meal => { if (!meal || typeof meal !== 'object') return; const mealDiv = document.createElement('div'); mealDiv.className = 'nutrition-item'; let mealText = `<strong>${meal.mealTime || 'ì‹ì‚¬'} ì‹ë‹¨:</strong> ${meal.suggestion || 'ì¶”ì²œ ì—†ìŒ'}`; if (includeExplanations && meal.focus) { mealText += `<div class='nutrition-info'>${meal.focus}</div>`; } mealDiv.innerHTML = mealText; nutritionContent.appendChild(mealDiv); }); } else { if (supplements.length > 0) { const noMealInfo = document.createElement('p'); noMealInfo.textContent = 'ì¶”ì²œ ì‹ë‹¨ ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤.'; noMealInfo.style.fontStyle = 'italic'; noMealInfo.style.fontSize='0.85rem'; noMealInfo.style.marginLeft = '10px'; nutritionContent.appendChild(noMealInfo); } } const randomSupplements = getRandomItems(supplements, 2); if (randomSupplements.length > 0) { const supplementDiv = document.createElement('div'); supplementDiv.className = 'nutrition-item'; let supplementText = `<strong>ë³´ì¶©ì œ (í•„ìš”ì‹œ):</strong> ${randomSupplements.map(s => s?.name || 'ì•Œ ìˆ˜ ì—†ìŒ').join(', ')}`; if (includeExplanations) { randomSupplements.forEach(s => { if (s?.name && s?.effect) supplementText += `<div class='nutrition-info'>${s.name}: ${s.effect}</div>`; else if (s?.effect) supplementText += `<div class='nutrition-info'>${s.effect}</div>`; }); } supplementDiv.innerHTML = supplementText; nutritionContent.appendChild(supplementDiv); } if (nutritionContent.hasChildNodes()) { container.appendChild(nutritionContent); } else { container.removeChild(nutritionCategory); } }
    // --- Loader, Print, Share, URL Functions (ì˜¤ë¥˜ ì²˜ë¦¬ ê°•í™”ë¨) ---
    function showLoader(message = "ì²˜ë¦¬ ì¤‘...") { const loader = document.getElementById('loader'); const loaderText = document.getElementById('loaderText'); if (loader && loaderText) { loaderText.textContent = message; loader.style.display = 'flex'; } else { console.error("Loader elements not found"); } } function hideLoader() { const loader = document.getElementById('loader'); if (loader) loader.style.display = 'none'; }
    function printSchedule() { console.log("printSchedule called"); try { const userName = document.getElementById('userName')?.value || 'ì‚¬ìš©ì'; const targetDiscipline = document.getElementById('targetDiscipline')?.value || 'N/A'; const currentPb = document.getElementById('currentPb')?.value || 'N/A'; const targetRecord = document.getElementById('targetRecord')?.value || 'N/A'; const trainingDays = document.getElementById('trainingDays')?.value || 'N/A'; const includeNutrition = document.getElementById('includeNutrition')?.value === 'yes'; const printUserTitle = document.getElementById('printUserNameTitle'); const printParams = document.getElementById('printParams'); const printHeader = document.getElementById('printHeaderInfo'); const precautionsContainer = document.getElementById('trainingPrecautionsContainer'); const nutritionTipsContainer = document.getElementById('generalNutritionTipsContainer'); if (!printUserTitle || !printParams || !printHeader || !precautionsContainer || !nutritionTipsContainer) { throw new Error("ì¸ì‡„ì— í•„ìš”í•œ ì¼ë¶€ HTML ìš”ì†Œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤."); } printUserTitle.textContent = `${userName}ë‹˜ì˜ ë”¥ í”„ë¦¬ë‹¤ì´ë¹™ íŠ¸ë ˆì´ë‹ ê³„íš`; printParams.innerHTML = `ì¢…ëª©: ${targetDiscipline} | í˜„ì¬ PB: ${currentPb}m | ëª©í‘œ PB: ${targetRecord}m | ê¸°ê°„: ${trainingDays}ì¼<br> ìƒì„±ì¼: ${new Date().toLocaleDateString('ko-KR')} | ì˜ì–‘ ì •ë³´: ${includeNutrition ? 'í¬í•¨' : 'ë¯¸í¬í•¨'}`; printHeader.style.display = 'block'; precautionsContainer.style.display = 'block'; if (includeNutrition && nutritionTipsContainer.innerHTML.trim() !== '') { nutritionTipsContainer.style.display = 'block'; } else { nutritionTipsContainer.style.display = 'none'; } console.log("Attempting window.print()"); window.print(); } catch(error) { console.error("Error during printSchedule:", error); alert(`ì¸ì‡„ ì¤‘ ì˜¤ë¥˜ ë°œìƒ: ${error.message}`); } }
    function openShareModal() { console.log("openShareModal called"); try { const modal = document.getElementById('shareModal'); if (!modal) throw new Error("ê³µìœ  ëª¨ë‹¬ ìš”ì†Œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤."); modal.style.display = 'flex'; } catch(error) { console.error("Error opening share modal:", error); alert(`ê³µìœ  ì˜µì…˜ì„ ì—¬ëŠ” ì¤‘ ì˜¤ë¥˜ ë°œìƒ: ${error.message}`); } } function closeShareModal() { try { const modal = document.getElementById('shareModal'); if (modal) modal.style.display = 'none'; } catch(error) { console.error("Error closing share modal:", error); } } function generateShareUrl() { console.log("generateShareUrl called"); try { const params = new URLSearchParams(); const getVal = (id) => { const el = document.getElementById(id); if (!el) console.warn(`generateShareUrl: Element '${id}' not found.`); return el?.value || ''; }; const getChecked = (name) => { const checked = Array.from(document.querySelectorAll(`input[name="${name}"]:checked`)).map(cb => cb.value); if (checked.length === 0) console.warn(`generateShareUrl: No checkboxes checked for name '${name}'.`); return checked.join(','); }; params.set('name', getVal('userName')); params.set('discipline', getVal('targetDiscipline') || 'CWT'); params.set('cpb', getVal('currentPb') || '0'); params.set('tr', getVal('targetRecord') || '0'); params.set('days', getVal('trainingDays') || '14'); params.set('nutrition', getVal('includeNutrition') || 'yes'); params.set('explain', getVal('includeExplanations') || 'yes'); const types = getChecked('trainingType'); if(types) params.set('types', types); const finalParams = new URLSearchParams(); for (const [key, value] of params.entries()) { if (value && value !== '0' && value !== 'no') { finalParams.set(key, value); } } const url = `${window.location.origin}${window.location.pathname}?${finalParams.toString()}`; console.log("Generated Share URL:", url); return url; } catch(error) { console.error("Error generating share URL:", error); throw new Error(`ê³µìœ  ë§í¬ ìƒì„± ì¤‘ ì˜¤ë¥˜ ë°œìƒ: ${error.message}`); } }
    function shareViaLink() { console.log("shareViaLink called"); try { const url = generateShareUrl(); if (!navigator.clipboard) { throw new Error("í´ë¦½ë³´ë“œ APIê°€ ì§€ì›ë˜ì§€ ì•ŠëŠ” ë¸Œë¼ìš°ì €ì…ë‹ˆë‹¤."); } navigator.clipboard.writeText(url).then(() => { alert("ìŠ¤ì¼€ì¤„ ë§í¬ê°€ í´ë¦½ë³´ë“œì— ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤."); closeShareModal(); }, (err) => { console.error('Clipboard write failed: ', err); prompt("í´ë¦½ë³´ë“œ ë³µì‚¬ ì‹¤íŒ¨. ì•„ë˜ ë§í¬ë¥¼ ì§ì ‘ ë³µì‚¬í•˜ì„¸ìš”:", url); closeShareModal(); }); } catch(error) { console.error("Error in shareViaLink:", error); alert(`ë§í¬ ê³µìœ  ì¤‘ ì˜¤ë¥˜ ë°œìƒ: ${error.message}`); closeShareModal(); } }
    function shareViaEmail() { console.log("shareViaEmail called"); try { const url = generateShareUrl(); const userName = document.getElementById('userName')?.value || 'í”„ë¦¬ë‹¤ì´ë²„'; const subject = `${userName}ë‹˜ì˜ íŠ¸ë ˆì´ë‹ ìŠ¤ì¼€ì¤„`; const body = `ì•ˆë…•í•˜ì„¸ìš”,\n\nìš”ì²­í•˜ì‹  í”„ë¦¬ë‹¤ì´ë¹™ íŠ¸ë ˆì´ë‹ ìŠ¤ì¼€ì¤„ ë§í¬ì…ë‹ˆë‹¤:\n${url}\n\nì•ˆì „í•˜ê³  ì¦ê±°ìš´ ë‹¤ì´ë¹™ ë˜ì„¸ìš”!`; window.location.href = `mailto:?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`; closeShareModal(); } catch(error) { console.error("Error in shareViaEmail:", error); alert(`ì´ë©”ì¼ ê³µìœ  ì¤€ë¹„ ì¤‘ ì˜¤ë¥˜ ë°œìƒ: ${error.message}`); closeShareModal(); } }
    function shareViaSocialMedia() { console.log("shareViaSocialMedia called"); try { const url = generateShareUrl(); const text = `ì €ì˜ í”„ë¦¬ë‹¤ì´ë¹™ ${document.getElementById('targetDiscipline')?.value || ''} ${document.getElementById('targetRecord')?.value || ''}m ë„ì „ ê³„íšì„ í™•ì¸í•´ë³´ì„¸ìš”!`; if (navigator.share) { navigator.share({ title: 'í”„ë¦¬ë‹¤ì´ë¹™ íŠ¸ë ˆì´ë‹ ê³„íš', text: text, url: url }) .then(() => { console.log('Successful share'); closeShareModal(); }) .catch((error) => { console.log('Error sharing:', error); alert(`SNS ê³µìœ  ì‹¤íŒ¨: ${error.message}`); closeShareModal();}); } else { alert(`SNS ê³µìœ :\nì œëª©: ${text}\në§í¬: ${url}\n\nìœ„ ë‚´ìš©ì„ ë³µì‚¬í•˜ì—¬ ì›í•˜ëŠ” SNSì— ê³µìœ í•˜ì„¸ìš”.`); closeShareModal(); } } catch(error) { console.error("Error in shareViaSocialMedia:", error); alert(`SNS ê³µìœ  ì¤€ë¹„ ì¤‘ ì˜¤ë¥˜ ë°œìƒ: ${error.message}`); closeShareModal(); } }
    // --- Load From URL Params (ë™ì¼) ---
    function loadFromUrlParams() { const params = new URLSearchParams(window.location.search); const setValue = (id, value, defaultValue) => { const element = document.getElementById(id); if (element) element.value = value !== null ? value : defaultValue; }; const setCheckboxes = (name, valuesString) => { const checkedValues = valuesString ? valuesString.split(',') : []; const defaultCheck = valuesString === null; document.querySelectorAll(`input[name="${name}"]`).forEach(cb => { cb.checked = defaultCheck || checkedValues.includes(cb.value); }); }; setValue('userName', params.get('name'), ''); setValue('targetDiscipline', params.get('discipline'), 'CWT'); setValue('currentPb', params.get('cpb'), ''); setValue('targetRecord', params.get('tr'), ''); setValue('trainingDays', params.get('days'), '14'); setValue('includeNutrition', params.get('nutrition'), 'yes'); setValue('includeExplanations', params.get('explain'), 'yes'); setCheckboxes('trainingType', params.get('types')); updateExperienceLevel(); }

    // --- Page Load Logic (DOMContentLoaded - ë™ì¼) ---
    document.addEventListener('DOMContentLoaded', function() { console.log("DOM Loaded. Starting setup..."); if (typeof data === 'undefined' || !data || Object.keys(data).length === 0) { console.error("CRITICAL ERROR: Global 'data' object is not defined or empty!"); alert("ë°ì´í„° ë¡œë”© ì˜¤ë¥˜! í˜ì´ì§€ë¥¼ ìƒˆë¡œê³ ì¹¨í•˜ì„¸ìš”."); const generateButton = document.querySelector('button[onclick="generateScheduleWrapper()"]'); if (generateButton) generateButton.disabled = true; return; } console.log("Data object check passed."); const criticalElementIds = [ 'userName', 'targetDiscipline', 'currentPb', 'targetRecord', 'trainingDays', 'experienceLevel', 'includeNutrition', 'includeExplanations', 'scheduleContainer', 'generalNutritionTipsContainer', 'trainingPrecautionsContainer', 'printUserNameTitle', 'printParams', 'subTitle', 'shareModal', 'loader', 'loaderText' ]; let allElementsFound = true; console.log("Checking for critical HTML elements..."); criticalElementIds.forEach(id => { const element = document.getElementById(id); if (!element) { console.error(`CRITICAL HTML ERROR: Element with ID '${id}' not found!`); allElementsFound = false; } }); if (!allElementsFound) { alert("í˜ì´ì§€ HTML êµ¬ì¡° ì˜¤ë¥˜ ë°œìƒ. í•„ìˆ˜ ìš”ì†Œ ëˆ„ë½. ì½˜ì†”(F12) í™•ì¸."); const genButton = document.querySelector('button[onclick="generateScheduleWrapper()"]'); if(genButton) genButton.disabled = true; return; } console.log("Critical element check passed."); try { console.log("Setting up listeners..."); const targetRecordInput = document.getElementById('targetRecord'); targetRecordInput.addEventListener('input', updateExperienceLevel); targetRecordInput.addEventListener('change', updateExperienceLevel); console.log("Target record listeners added."); console.log("Calling loadFromUrlParams..."); loadFromUrlParams(); console.log("loadFromUrlParams finished."); console.log("Setting initial message in schedule container."); const scheduleContainer = document.getElementById('scheduleContainer'); scheduleContainer.innerHTML = '<p style="text-align: center; color: #555; margin-top: 2rem;">í›ˆë ¨ ê³„íšì„ ë³´ë ¤ë©´ í˜„ì¬ PBì™€ ëª©í‘œ ìˆ˜ì‹¬ì„ ì…ë ¥(ë˜ëŠ” í™•ì¸)í•˜ê³  \'ìŠ¤ì¼€ì¤„ ìƒì„±í•˜ê¸°\'ë¥¼ í´ë¦­í•˜ì„¸ìš”.</p>'; scheduleContainer.className = ''; console.log("Setting up modal listener..."); const modal = document.getElementById('shareModal'); window.onclick = function(event) { if (event.target === modal) { closeShareModal(); } }; console.log("Modal listener setup complete."); /* PWA Service Worker Registration */ if ('serviceWorker' in navigator) { console.log("Service Worker supported, attempting registration..."); window.addEventListener('load', () => { navigator.serviceWorker.register('/sw.js') .then(registration => { console.log('ServiceWorker registration successful with scope: ', registration.scope); }) .catch(error => { console.error('ServiceWorker registration failed: ', error); }); }); } else { console.log("Service Worker not supported by this browser."); } console.log("DOMContentLoaded setup fully completed."); } catch (error) { console.error("Error during DOMContentLoaded setup:", error); alert(`í˜ì´ì§€ ì´ˆê¸°í™” ì¤‘ ì˜¤ë¥˜ ë°œìƒ:\n${error.message}\n\nì½˜ì†”(F12)ì„ í™•ì¸í•˜ì—¬ ê´€ë ¨ ì½”ë“œë¥¼ ì ê²€í•˜ì„¸ìš”.`); try { hideLoader(); } catch(e) {} } });
  </script>
</body>
</html>